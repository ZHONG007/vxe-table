"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _vue=require("vue"),_xeUtils=_interopRequireDefault(require("xe-utils")),_dom=require("../../tools/dom"),_utils=require("../../tools/utils"),_resize=require("../../tools/resize"),_event=require("../../tools/event"),_size=require("../../hooks/size"),_vXETable=require("../../v-x-e-table"),_conf=_interopRequireDefault(require("../../v-x-e-table/src/conf")),_cell=_interopRequireDefault(require("./cell")),_body=_interopRequireDefault(require("./body")),_props=_interopRequireDefault(require("./props")),_emits=_interopRequireDefault(require("./emits")),_util=require("./util");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var __assign=function(){return(__assign=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var l in t=arguments[r])Object.prototype.hasOwnProperty.call(t,l)&&(e[l]=t[l]);return e}).apply(this,arguments)},__spreadArray=function(e,t){for(var r=0,n=t.length,l=e.length;r<n;r++,l++)e[l]=t[r];return e},isWebkit=_dom.browse["-webkit"]&&!_dom.browse.edge,resizableStorageKey="VXE_TABLE_CUSTOM_COLUMN_WIDTH",visibleStorageKey="VXE_TABLE_CUSTOM_COLUMN_VISIBLE",_default=(0,_vue.defineComponent)({name:"VxeTable",props:_props.default,emits:_emits.default,setup:function(P,e){var _,A=e.slots,n=e.emit,F=_vXETable.VXETable.tooltip,N=_xeUtils.default.uniqueId(),V=(0,_size.useSize)(P),t=(0,_vue.getCurrentInstance)(),Y=(0,_vue.reactive)({staticColumns:[],tableGroupColumn:[],tableColumn:[],tableData:[],scrollXLoad:!1,scrollYLoad:!1,overflowY:!0,overflowX:!1,scrollbarWidth:0,scrollbarHeight:0,rowHeight:0,parentHeight:0,isGroup:!1,isAllOverflow:!1,isAllSelected:!1,isIndeterminate:!1,selection:[],currentRow:null,currentColumn:null,selectRow:null,footerTableData:[],expandColumn:null,treeNodeColumn:null,hasFixedColumn:!1,rowExpandeds:[],expandLazyLoadeds:[],treeExpandeds:[],treeLazyLoadeds:[],treeIndeterminates:[],mergeList:[],mergeFooterList:[],initStore:{filter:!1,import:!1,export:!1},filterStore:{isAllSelected:!1,isIndeterminate:!1,style:null,options:[],column:null,multiple:!1,visible:!1,maxHeight:null},columnStore:{leftList:[],centerList:[],rightList:[],resizeList:[],pxList:[],pxMinList:[],scaleList:[],scaleMinList:[],autoList:[]},ctxMenuStore:{selected:null,visible:!1,showChild:!1,selectChild:null,list:[],style:null},editStore:{indexs:{columns:[]},titles:{columns:[]},selected:{row:null,column:null},copyed:{cut:!1,rows:[],columns:[]},actived:{row:null,column:null},insertList:[],removeList:[]},validStore:{visible:!1,row:null,column:null,content:"",rule:null,isArrow:!1},importStore:{inited:!1,file:null,type:"",modeList:[],typeList:[],filename:"",visible:!1},importParams:{mode:"",types:null,message:!0},exportStore:{inited:!1,name:"",modeList:[],typeList:[],columns:[],isPrint:!1,hasFooter:!1,hasMerge:!1,hasTree:!1,hasColgroup:!1,visible:!1},exportParams:{filename:"",sheetName:"",mode:"",type:"",isColgroup:!1,isMerge:!1,isAllExpand:!1,useStyle:!1,original:!1,message:!0,isHeader:!1,isFooter:!1}}),B={tZindex:0,elemStore:{},scrollXStore:{offsetSize:0,visibleSize:0,startIndex:0,endIndex:0},scrollYStore:{rowHeight:0,offsetSize:0,visibleSize:0,startIndex:0,endIndex:0},tooltipStore:{},tableWidth:0,tableHeight:0,headerHeight:0,footerHeight:0,customHeight:0,customMaxHeight:0,hoverRow:null,lastScrollLeft:0,lastScrollTop:0,lastScrollTime:0,radioReserveRow:null,checkboxReserveRowMap:{},rowExpandedReserveRowMap:{},treeExpandedReserveRowMap:{},tableFullData:[],afterFullData:[],tableSynchData:[],tableSourceData:[],collectColumn:[],tableFullColumn:[],visibleColumn:[],fullAllDataRowIdData:{},fullDataRowIdData:{},fullColumnIdData:{},fullColumnFieldData:{},inited:!1,tooltipActive:!1,tooltipTimeout:null,initStatus:!1,isActivated:!1},G={},Z={},z=(0,_vue.ref)(),H=(0,_vue.ref)(),q=(0,_vue.ref)(),$=(0,_vue.ref)(),X=(0,_vue.ref)(),j=(0,_vue.ref)(),W=(0,_vue.ref)(),K=(0,_vue.ref)(),J=(0,_vue.ref)(),s=(0,_vue.ref)(),d=(0,_vue.ref)(),f=(0,_vue.ref)(),v=(0,_vue.ref)(),g=(0,_vue.ref)(),h=(0,_vue.ref)(),Q=(0,_vue.ref)(),ee=(0,_vue.ref)(),te=(0,_vue.ref)(),re=(0,_vue.ref)(),x=(0,_vue.inject)("$xegrid",null),ne=(0,_vue.computed)(function(){return Object.assign({},_conf.default.table.validConfig,P.validConfig)}),m=(0,_vue.computed)(function(){return Object.assign({},_conf.default.table.scrollX,P.scrollX)}),w=(0,_vue.computed)(function(){return Object.assign({},_conf.default.table.scrollY,P.scrollY)}),p=(0,_vue.computed)(function(){return{default:48,medium:44,small:40,mini:36}}),b=(0,_vue.computed)(function(){return Object.assign({},P.columnConfig)}),r=(0,_vue.computed)(function(){return Object.assign({},_conf.default.table.resizableConfig,P.resizableConfig)}),l=(0,_vue.computed)(function(){return Object.assign({startIndex:0},_conf.default.table.seqConfig,P.seqConfig)}),E=(0,_vue.computed)(function(){return Object.assign({},_conf.default.table.radioConfig,P.radioConfig)}),R=(0,_vue.computed)(function(){return Object.assign({},_conf.default.table.checkboxConfig,P.checkboxConfig)}),le=(0,_vue.ref)(),o=function(){var e=le.value;return setTimeout(function(){B.tooltipActive||G.closeTooltip()},e.leaveDelay),!1};le=(0,_vue.computed)(function(){var e=Object.assign({leaveDelay:300},_conf.default.table.tooltipConfig,P.tooltipConfig);return e.enterable&&(e.leaveMethod=o),e});var oe,ie=(0,_vue.computed)(function(){var e=le.value;return Object.assign({isArrow:!1},e)}),ae=(0,_vue.computed)(function(){return Object.assign({},_conf.default.table.editConfig,P.editConfig)}),C=(0,_vue.computed)(function(){return Object.assign({orders:["asc","desc",null]},_conf.default.table.sortConfig,P.sortConfig)}),T=(0,_vue.computed)(function(){return Object.assign({},_conf.default.table.filterConfig,P.filterConfig)}),ue=(0,_vue.computed)(function(){return Object.assign({},_conf.default.table.mouseConfig,P.mouseConfig)}),i=(0,_vue.computed)(function(){return Object.assign({},_conf.default.table.areaConfig,P.areaConfig)}),ce=(0,_vue.computed)(function(){return Object.assign({},_conf.default.table.keyboardConfig,P.keyboardConfig)}),a=(0,_vue.computed)(function(){return Object.assign({},_conf.default.table.clipConfig,P.clipConfig)}),u=(0,_vue.computed)(function(){return Object.assign({},_conf.default.table.fnrConfig,P.fnrConfig)}),c=(0,_vue.computed)(function(){return Object.assign({},_conf.default.table.menuConfig,P.menuConfig)}),y=(0,_vue.computed)(function(){var e=c.value.header;return e&&e.options?e.options:[]}),se=(0,_vue.computed)(function(){var e=c.value.body;return e&&e.options?e.options:[]}),S=(0,_vue.computed)(function(){var e=c.value.footer;return e&&e.options?e.options:[]}),de=(0,_vue.computed)(function(){var e=c.value,t=y.value,r=se.value,n=S.value;return!!(P.menuConfig&&(0,_utils.isEnableConf)(e)&&(t.length||r.length||n.length))}),fe=(0,_vue.computed)(function(){var e=Y.ctxMenuStore,t=[];return e.list.forEach(function(e){e.forEach(function(e){t.push(e)})}),t}),I=(0,_vue.computed)(function(){return Object.assign({},_conf.default.table.exportConfig,P.exportConfig)}),D=(0,_vue.computed)(function(){return Object.assign({},_conf.default.table.importConfig,P.importConfig)}),k=(0,_vue.computed)(function(){return Object.assign({},_conf.default.table.printConfig,P.printConfig)}),L=(0,_vue.computed)(function(){return Object.assign({},_conf.default.table.expandConfig,P.expandConfig)}),ve=(0,_vue.computed)(function(){return Object.assign({},_conf.default.table.treeConfig,P.treeConfig)}),ge=(0,_vue.computed)(function(){return Object.assign({},_conf.default.table.emptyRender,P.emptyRender)}),he=(0,_vue.computed)(function(){return P.border?Math.max(2,Math.ceil(Y.scrollbarWidth/Y.tableColumn.length)):1}),U=(0,_vue.computed)(function(){return Object.assign({},_conf.default.table.customConfig,P.customConfig)}),xe=(0,_vue.computed)(function(){var e=P.border;return!0===e?"full":e||"default"}),O=(0,_vue.computed)(function(){P.treeConfig;var e=Y.tableData,t=B.tableFullData,r=R.value,n=r.strict,l=r.checkMethod;return!!n&&(!e.length&&!t.length||!!l&&t.every(function(e){return!l({row:e})}))}),M={refElem:z,refTooltip:H,refValidTooltip:$,refTableFilter:X,refTableMenu:j,refTableHeader:W,refTableBody:K,refTableFooter:J,refTableLeftHeader:s,refTableLeftBody:d,refTableLeftFooter:f,refTableRightHeader:v,refTableRightBody:g,refTableRightFooter:h,refLeftContainer:Q,refRightContainer:ee,refCellResizeBar:te},me={computeSize:V,computeValidOpts:ne,computeSXOpts:m,computeSYOpts:w,computeResizableOpts:r,computeSeqOpts:l,computeRadioOpts:E,computeCheckboxOpts:R,computeTooltipOpts:le,computeEditOpts:ae,computeSortOpts:C,computeFilterOpts:T,computeMouseOpts:ue,computeAreaOpts:i,computeKeyboardOpts:ce,computeClipOpts:a,computeFNROpts:u,computeHeaderMenu:y,computeBodyMenu:se,computeFooterMenu:S,computeIsMenu:de,computeMenuOpts:c,computeExportOpts:I,computeImportOpts:D,computePrintOpts:k,computeExpandOpts:L,computeTreeOpts:ve,computeEmptyOpts:ge,computeCustomOpts:U,computeIsAllCheckboxDisabled:O},pe={xID:N,props:P,context:e,instance:t,reactData:Y,internalData:B,getRefMaps:function(){return M},getComputeMaps:function(){return me},xegrid:x},_e=function(e,t,r){var n=_xeUtils.default.get(e,r),l=_xeUtils.default.get(t,r);return!(!(0,_utils.eqEmptyValue)(n)||!(0,_utils.eqEmptyValue)(l))||(_xeUtils.default.isString(n)||_xeUtils.default.isNumber(n)?n==l:_xeUtils.default.isEqual(n,l))},we=function(e){var t=C.value.orders,r=e.order||null,n=t.indexOf(r)+1;return t[n<t.length?n:0]},be=function(e){var t=_conf.default.version,r=_xeUtils.default.toStringJSON(localStorage.getItem(e)||"");return r&&r._v===t?r:{_v:t}},Ce=function(e){var r=B.fullAllDataRowIdData;return e.filter(function(e){var t=(0,_util.getRowid)(pe,e);return!!r[t]})},Ee=function(e){var r=B.fullDataRowIdData,n=[];return _xeUtils.default.each(e,function(e,t){r[t]&&-1===pe.findRowIndexOf(n,r[t].row)&&n.push(r[t].row)}),n},Re=function(){var e=B.visibleColumn,t=K.value,r=t?t.$el:null;if(r){for(var n=r.scrollLeft,l=n+r.clientWidth,o=-1,i=0,a=0,u=0,c=e.length;u<c&&(i+=e[u].renderWidth,-1===o&&n<i&&(o=u),!(0<=o&&(a++,l<i)));u++);return{toVisibleIndex:Math.max(0,o),visibleSize:Math.max(8,a)}}return{toVisibleIndex:0,visibleSize:8}},Te=function(e,t,r){for(var n=0,l=e.length;n<l;n++){var o=e[n],i=t.startIndex,a=t.endIndex,u=o[r],c=u+o[r+"span"];u<i&&i<c&&(t.startIndex=u),u<a&&a<c&&(t.endIndex=c),t.startIndex===i&&t.endIndex===a||(n=-1)}},ye=function(e,c,s){if(e){var t=P.treeConfig,d=B.visibleColumn;if(t)return void(0,_utils.errLog)("vxe.error.noTree",["merge-footer-items"]);_xeUtils.default.isArray(e)||(e=[e]),e.forEach(function(e){var t=e.row,r=e.col,n=e.rowspan,l=e.colspan;if(s&&_xeUtils.default.isNumber(t)&&(t=s[t]),_xeUtils.default.isNumber(r)&&(r=d[r]),(s?t:_xeUtils.default.isNumber(t))&&r&&(n||l)&&(n=_xeUtils.default.toNumber(n)||1,l=_xeUtils.default.toNumber(l)||1,1<n||1<l)){var o=_xeUtils.default.findIndexOf(c,function(e){return!(e._row!==t&&(0,_util.getRowid)(pe,e._row)!==(0,_util.getRowid)(pe,t)||e._col.id!==r&&e._col.id!==r.id)}),i=c[o];if(i)i.rowspan=n,i.colspan=l,i._rowspan=n,i._colspan=l;else{var a=s?pe.findRowIndexOf(s,t):t,u=G.getVTColumnIndex(r);c.push({row:a,col:u,rowspan:n,colspan:l,_row:t,_col:r,_rowspan:n,_colspan:l})}}})}},Se=function(e,o,i){var a=[];if(e){var t=P.treeConfig,u=B.visibleColumn;if(t)throw new Error((0,_utils.getLog)("vxe.error.noTree",["merge-cells"]));_xeUtils.default.isArray(e)||(e=[e]),e.forEach(function(e){var t=e.row,r=e.col;i&&_xeUtils.default.isNumber(t)&&(t=i[t]),_xeUtils.default.isNumber(r)&&(r=u[r]);var n=_xeUtils.default.findIndexOf(o,function(e){return!(e._row!==t&&(0,_util.getRowid)(pe,e._row)!==(0,_util.getRowid)(pe,t)||e._col.id!==r&&e._col.id!==r.id)});if(-1<n){var l=o.splice(n,1);a.push(l[0])}})}return a},Ie=function(){B.tableFullColumn.forEach(function(e){e.order=null})},De=function(e){var t=Y.parentHeight,r=P[e],n=0;if(r)if("auto"===r)n=t;else{var l=pe.getExcludeHeight();n=(0,_dom.isScale)(r)?Math.floor((_xeUtils.default.toInteger(r)||1)/100*t):_xeUtils.default.toNumber(r),n=Math.max(40,n-l)}return n},ke=function(){B.customHeight=De("height"),B.customMaxHeight=De("maxHeight")},Le=function(e,t,r){var n=0,l=t.clientWidth-1,o=l,i=o/100,a=P.fit,u=Y.columnStore,c=u.resizeList,s=u.pxMinList,d=u.pxList,f=u.scaleList,v=u.scaleMinList,g=u.autoList;if(s.forEach(function(e){var t=parseInt(e.minWidth);n+=t,e.renderWidth=t}),v.forEach(function(e){var t=Math.floor(parseInt(e.minWidth)*i);n+=t,e.renderWidth=t}),f.forEach(function(e){var t=Math.floor(parseInt(e.width)*i);n+=t,e.renderWidth=t}),d.forEach(function(e){var t=parseInt(e.width);n+=t,e.renderWidth=t}),c.forEach(function(e){var t=parseInt(e.resizeWidth);n+=t,e.renderWidth=t}),i=0<(o-=n)?Math.floor(o/(v.length+s.length+g.length)):0,a?0<o&&v.concat(s).forEach(function(e){n+=i,e.renderWidth+=i}):i=40,g.forEach(function(e){var t=Math.max(i,40);e.renderWidth=t,n+=t}),a){var h=f.concat(v).concat(s).concat(g),x=h.length-1;if(0<x){var m=l-n;if(0<m){for(;0<m&&0<=x;)m--,h[x--].renderWidth++;n=l}}}var p=t.offsetHeight,_=t.scrollHeight>t.clientHeight,w=0;_&&(w=Math.max(t.offsetWidth-t.clientWidth,0)),Y.scrollbarWidth=w,Y.overflowY=_,B.tableWidth=n,B.tableHeight=p;var b=0;e&&(b=e.clientHeight,(0,_vue.nextTick)(function(){e&&t&&e.scrollLeft!==t.scrollLeft&&(e.scrollLeft=t.scrollLeft)})),B.headerHeight=b;var C=!1,E=0,R=0;r?(E=r.offsetHeight,(C=n>r.clientWidth)&&(R=Math.max(E-r.clientHeight,0))):(C=l<n)&&(R=Math.max(p-t.clientHeight,0)),B.footerHeight=E,Y.overflowX=C,Y.scrollbarHeight=R,ke(),Y.parentHeight=Math.max(B.headerHeight+E+20,Z.getParentHeight()),C&&Z.checkScrolling()},Ue=function(){var e=B.afterFullData,l=B.fullDataRowIdData;e.forEach(function(e,t){var r=(0,_util.getRowid)(pe,e),n=l[r];n?n._index=t:l[r]={row:e,rowid:r,index:-1,$index:-1,_index:t,items:[],parent:null}})},Oe=function(){var e=B.tableFullColumn,t=B.tableFullData,r=T.value,n=C.value,i=r.remote,d=r.filterMethod,a=n.remote,l=n.sortMethod,o=t.slice(0);if(!i||!a){var u=[],c=[];if(e.forEach(function(e){var t=e.sortable,r=e.order,n=e.filters;if(!i&&n&&n.length){var l=[],o=[];n.forEach(function(e){e.checked&&(o.push(e),l.push(e.value))}),o.length&&u.push({column:e,valueList:l,itemList:o})}!a&&t&&r&&c.push({column:e,property:e.property,order:r})}),!i&&u.length&&(o=o.filter(function(s){return u.every(function(e){var t=e.column,r=e.valueList,n=e.itemList,l=t.filterMethod,o=t.filterRender,i=o?_vXETable.VXETable.renderer.get(o.name):null,a=i?i.filterMethod:null,u=i?i.defaultFilterMethod:null,c=(0,_util.getCellValue)(s,t);return l?n.some(function(e){return l({value:e.value,option:e,cellValue:c,row:s,column:t,$table:pe})}):a?n.some(function(e){return a({value:e.value,option:e,cellValue:c,row:s,column:t,$table:pe})}):d?d({options:n,values:r,cellValue:c,row:s,column:t}):u?n.some(function(e){return u({value:e.value,option:e,cellValue:c,row:s,column:t,$table:pe})}):-1<r.indexOf(_xeUtils.default.get(s,t.property))})})),!a&&c.length)if(l){var s=l({data:o,sortList:c,$table:pe});o=_xeUtils.default.isArray(s)?s:o}else o=_xeUtils.default.orderBy(o,c.map(function(e){var r,n,l,t=e.column,o=e.order;return[(r=t,n=r.sortBy,l=r.sortType,function(e){var t;return t=n?_xeUtils.default.isFunction(n)?n({row:e,column:r}):_xeUtils.default.get(e,n):Z.getCellLabel(e,r),l&&"auto"!==l?"number"===l?_xeUtils.default.toNumber(t):"string"===l?_xeUtils.default.toValueString(t):t:isNaN(t)?t:_xeUtils.default.toNumber(t)}),o]}))}return B.afterFullData=o,Ue(),o},Me=function(){var g=P.border,h=P.showFooter,x=P.showOverflow,m=P.showHeaderOverflow,p=P.showFooterOverflow,e=P.mouseConfig,_=P.spanMethod,w=P.footerSpanMethod,b=P.keyboardConfig,C=Y.isGroup,t=Y.currentRow,E=Y.tableColumn,R=Y.scrollXLoad,T=Y.scrollYLoad,y=Y.scrollbarWidth,S=Y.scrollbarHeight,r=Y.columnStore,n=Y.editStore,I=Y.mergeList,D=Y.mergeFooterList,k=Y.isAllOverflow,L=B.visibleColumn,U=B.fullColumnIdData,O=B.tableHeight,M=B.tableWidth,A=B.headerHeight,F=B.footerHeight,N=B.elemStore,V=B.customHeight,z=B.customMaxHeight,l=re.value,H=he.value,o=ue.value,q=ce.value,i=N["main-body-wrapper"];return l&&(l.style.top=A+"px",l.style.height=i?i.offsetHeight-S+"px":""),0<V&&h&&(V+=S),["main","left","right"].forEach(function(s,e){var u,d=0<e?s:"",f="left"===d,v=[];d&&(v=f?r.leftList:r.rightList,u=f?Q.value:ee.value),["header","body","footer"].forEach(function(c){var e=N[s+"-"+c+"-wrapper"],t=N[s+"-"+c+"-table"];if("header"===c){var r=M,n=!1;C||d&&(R||m)&&(n=!0),n&&(E=v),(n||R)&&(r=E.reduce(function(e,t){return e+t.renderWidth},0)),t&&(t.style.width=r?r+y+"px":"",_dom.browse.msie&&_xeUtils.default.arrayEach(t.querySelectorAll(".vxe-resizable"),function(e){e.style.height=e.parentNode.offsetHeight+"px"}));var l=N[s+"-"+c+"-repair"];l&&(l.style.width=M+"px");var o=N[s+"-"+c+"-list"];C&&o&&_xeUtils.default.arrayEach(o.querySelectorAll(".col--group"),function(e){var t=G.getColumnNode(e);if(t){var r=t.item,n=r.showHeaderOverflow,l=_xeUtils.default.isBoolean(n)?n:m,o="title"===l||(!0===l||"tooltip"===l)||"ellipsis"===l,i=0,a=0;o&&_xeUtils.default.eachTree(r.children,function(e){e.children&&r.children.length||a++,i+=e.renderWidth}),e.style.width=o?i-a-(g?2:0)+"px":""}})}else if("body"===c){var i=N[s+"-"+c+"-emptyBlock"];e&&(z?e.style.maxHeight=(d?z-A-(h?0:S):z-A)+"px":e.style.height=0<V?(d?(0<V?V-A-F:O)-(h?0:S):V-A-F)+"px":""),u&&(e&&(e.style.top=A+"px"),u.style.height=(0<V?V-A-F:O)+A+F-S*(h?2:1)+"px",u.style.width=v.reduce(function(e,t){return e+t.renderWidth},f?0:y)+"px");r=M;d&&(E=R||T||(x?k:x)?I.length||_||b&&q.isMerge?L:v:L),r=E.reduce(function(e,t){return e+t.renderWidth},0),t&&(t.style.width=r?r+"px":"",t.style.paddingRight=y&&d&&(_dom.browse["-moz"]||_dom.browse.safari)?y+"px":""),i&&(i.style.width=r?r+"px":"")}else if("footer"===c){r=M;d&&(E=R||p?D.length&&w?L:v:L),r=E.reduce(function(e,t){return e+t.renderWidth},0),e&&(u&&(e.style.top=(0<V?V-F:O+A)+"px"),e.style.marginTop=-Math.max(1,S)+"px"),t&&(t.style.width=r?r+y+"px":"")}var a=N[s+"-"+c+"-colgroup"];a&&_xeUtils.default.arrayEach(a.children,function(e){var t=e.getAttribute("name");if("col_gutter"===t&&(e.style.width=y+"px"),U[t]){var a=U[t].column,r=a.showHeaderOverflow,n=a.showFooterOverflow,l=a.showOverflow,o=void 0;e.style.width=a.renderWidth+"px";var u="title"===(o="header"===c?_xeUtils.default.isUndefined(r)||_xeUtils.default.isNull(r)?m:r:"footer"===c?_xeUtils.default.isUndefined(n)||_xeUtils.default.isNull(n)?p:n:_xeUtils.default.isUndefined(l)||_xeUtils.default.isNull(l)?x:l)||(!0===o||"tooltip"===o)||"ellipsis"===o,i=N[s+"-"+c+"-list"];"header"===c||"footer"===c?R&&!u&&(u=!0):!R&&!T||u||(u=!0),i&&_xeUtils.default.arrayEach(i.querySelectorAll("."+a.id),function(e){var t=parseInt(e.getAttribute("colspan")||1),r=e.querySelector(".vxe-cell"),n=a.renderWidth;if(r){if(1<t)for(var l=G.getColumnIndex(a),o=1;o<t;o++){var i=G.getColumns(l+o);i&&(n+=i.renderWidth)}r.style.width=u?n-H*t+"px":""}})}})})}),t&&G.setCurrentRow(t),e&&o.selected&&n.selected.row&&n.selected.column&&pe.addCellSelectedClass(),(0,_vue.nextTick)()},Ae=function(e){return pe.triggerValidate?pe.triggerValidate(e):(0,_vue.nextTick)()},Fe=function(e,t){Ae("blur").catch(function(e){return e}).then(function(){pe.handleActived(t,e).then(function(){return Ae("change")}).catch(function(e){return e})})},Ne=function(e,t){var r=B.checkboxReserveRowMap;if(R.value.reserve){var n=(0,_util.getRowid)(pe,e);t?r[n]=e:r[n]&&delete r[n]}},Ve=function(r){var n=Y.treeExpandeds,l=Y.treeLazyLoadeds,e=B.fullAllDataRowIdData,t=ve.value,o=R.value,i=t.loadMethod,a=o.checkStrictly,u=e[(0,_util.getRowid)(pe,r)];return new Promise(function(t){i?(l.push(r),i({$table:pe,row:r}).catch(function(){return[]}).then(function(e){u.treeLoaded=!0,_xeUtils.default.remove(l,function(e){return pe.eqRow(e,r)}),_xeUtils.default.isArray(e)||(e=[]),e&&G.loadChildren(r,e).then(function(e){e.length&&-1===pe.findRowIndexOf(n,r)&&n.push(r),!a&&G.isCheckedByCheckboxRow(r)&&G.setCheckboxRow(e,!0)}),t((0,_vue.nextTick)().then(function(){return G.recalculate()}))})):t()})},ze=function(e,t){var r=B.treeExpandedReserveRowMap;if(ve.value.reserve){var n=(0,_util.getRowid)(pe,e);t?r[n]=e:r[n]&&delete r[n]}},He=function(r){var n=Y.rowExpandeds,l=Y.expandLazyLoadeds,o=B.fullAllDataRowIdData[(0,_util.getRowid)(pe,r)];return new Promise(function(e){var t=L.value.loadMethod;t?(l.push(r),t({$table:pe,row:r,rowIndex:G.getRowIndex(r),$rowIndex:G.getVMRowIndex(r)}).catch(function(e){return e}).then(function(){o.expandLoaded=!0,_xeUtils.default.remove(l,function(e){return pe.eqRow(e,r)}),n.push(r),e((0,_vue.nextTick)().then(function(){return G.recalculate()}))})):e()})},qe=function(e,t){var r=B.rowExpandedReserveRowMap;if(L.value.reserve){var n=(0,_util.getRowid)(pe,e);t?r[n]=e:r[n]&&delete r[n]}},$e=function(){return(0,_vue.nextTick)().then(function(){var e=Y.scrollXLoad,t=Y.scrollYLoad,r=B.scrollXStore,n=B.scrollYStore,l=w.value,o=m.value;if(e){var i=Re().visibleSize,a=o.oSize?_xeUtils.default.toNumber(o.oSize):_dom.browse.msie?10:_dom.browse.edge?5:0;r.offsetSize=a,r.visibleSize=i,r.endIndex=Math.max(r.startIndex+r.visibleSize+a,r.endIndex),Z.updateScrollXData()}else Z.updateScrollXSpace();var u=function(){var e=W.value,t=K.value,r=t?t.$el:null,n=V.value,l=p.value;if(r){var o=e?e.$el:null,i=0,a=void 0;return!(a=r.querySelector("tr"))&&o&&(a=o.querySelector("tr")),a&&(i=a.clientHeight),i||(i=l[n||"default"]),{rowHeight:i,visibleSize:Math.max(8,Math.ceil(r.clientHeight/i)+2)}}return{rowHeight:0,visibleSize:8}}(),c=u.rowHeight,s=u.visibleSize;if(n.rowHeight=c,t){var d=l.oSize?_xeUtils.default.toNumber(l.oSize):_dom.browse.msie?20:_dom.browse.edge?10:0;n.offsetSize=d,n.visibleSize=s,n.endIndex=Math.max(n.startIndex+s+d,n.endIndex),Z.updateScrollYData()}else Z.updateScrollYSpace();Y.rowHeight=c,(0,_vue.nextTick)(Me)})},Xe=function(e){var t=P.keepSource,r=P.treeConfig,n=Y.editStore,l=Y.scrollYLoad,o=B.scrollYStore,i=B.scrollXStore,a=B.lastScrollLeft,u=B.lastScrollTop,c=w.value,s=e?e.slice(0):[],d=!r&&!!c.enabled&&-1<c.gt&&c.gt<s.length;return o.startIndex=0,o.endIndex=1,i.startIndex=0,i.endIndex=1,n.insertList=[],n.removeList=[],B.tableFullData=s,Z.updateCache(!0),B.tableSynchData=e,t&&(B.tableSourceData=_xeUtils.default.clone(s,!0)),Y.scrollYLoad=d,"development"===process.env.NODE_ENV&&d&&(P.height||P.maxHeight||(0,_utils.errLog)("vxe.error.reqProp",["table.height | table.max-height | table.scroll-y={enabled: false}"]),P.showOverflow||(0,_utils.warnLog)("vxe.error.reqProp",["table.show-overflow"]),P.spanMethod&&(0,_utils.warnLog)("vxe.error.scrollErrProp",["table.span-method"])),pe.clearCellAreas&&P.mouseConfig&&(pe.clearCellAreas(),pe.clearCopyCellArea()),G.clearMergeCells(),G.clearMergeFooterItems(),Z.handleTableData(!0),G.updateFooter(),(0,_vue.nextTick)().then(function(){ke(),Me()}).then(function(){$e()}).then(function(){return d&&(o.endIndex=o.visibleSize),function(){var e=P.treeConfig,t=Y.expandColumn,r=Y.currentRow,n=Y.selectRow,l=Y.selection,o=Y.rowExpandeds,i=Y.treeExpandeds,a=B.fullDataRowIdData,u=B.fullAllDataRowIdData,c=B.radioReserveRow,s=L.value,d=ve.value,f=E.value,v=R.value;if(n&&!u[(0,_util.getRowid)(pe,n)]&&(Y.selectRow=null),f.reserve&&c){var g=(0,_util.getRowid)(pe,c);a[g]&&G.setRadioRow(a[g].row)}Y.selection=Ce(l),v.reserve&&G.setCheckboxRow(Ee(B.checkboxReserveRowMap),!0),r&&!u[(0,_util.getRowid)(pe,r)]&&(Y.currentRow=null),Y.rowExpandeds=t?Ce(o):[],t&&s.reserve&&G.setRowExpand(Ee(B.rowExpandedReserveRowMap),!0),Y.treeExpandeds=e?Ce(i):[],e&&d.reserve&&G.setTreeExpand(Ee(B.treeExpandedReserveRowMap),!0)}(),Z.checkSelectionStatus(),new Promise(function(e){(0,_vue.nextTick)().then(function(){return G.recalculate()}).then(function(){l===d?(0,_util.restoreScrollLocation)(pe,a,u).then(e):setTimeout(function(){return(0,_util.restoreScrollLocation)(pe,a,u).then(e)})})})})},je=function(){var e,t;!function(){if(P.checkboxConfig){var t=B.fullDataRowIdData,e=R.value,r=e.checkAll,n=e.checkRowKeys;if(r)G.setAllCheckboxRow(!0);else if(n){var l=[];n.forEach(function(e){t[e]&&l.push(t[e].row)}),G.setCheckboxRow(l,!0)}}}(),function(){var e;if(P.radioConfig){var t=B.fullDataRowIdData,r=E.value,n=r.checkRowKey,l=r.reserve;if(n&&(t[n]&&G.setRadioRow(t[n].row),l)){var o=(0,_util.getRowkey)(pe);B.radioReserveRow=((e={})[o]=n,e)}}}(),function(){if(P.expandConfig){var t=B.fullDataRowIdData,e=L.value,r=e.expandAll,n=e.expandRowKeys;if(r)G.setAllRowExpand(!0);else if(n){var l=[];n.forEach(function(e){t[e]&&l.push(t[e].row)}),G.setRowExpand(l,!0)}}}(),function(){if(P.treeConfig){var r=B.tableFullData,n=ve.value,e=n.expandAll,t=n.expandRowKeys;if(e)G.setAllTreeExpand(!0);else if(t){var l=[],o=(0,_util.getRowkey)(pe);t.forEach(function(t){var e=_xeUtils.default.findTree(r,function(e){return t===_xeUtils.default.get(e,o)},n);e&&l.push(e.item)}),G.setTreeExpand(l,!0)}}}(),(e=P.mergeCells)&&G.setMergeCells(e),(t=P.mergeFooterItems)&&G.setMergeFooterItems(t),(0,_vue.nextTick)(function(){return setTimeout(function(){return G.recalculate()})})},We=function(){!function(){var e=P.sortConfig;if(e){var t=C.value,r=t.defaultSort;r&&(_xeUtils.default.isArray(r)||(r=[r]),r.length&&((e.multiple?r:r.slice(0,1)).forEach(function(e){var t=e.field,r=e.order;if(t&&r){var n=G.getColumnByField(t);n&&n.sortable&&(n.order=r)}}),t.remote||Z.handleTableData(!0).then(Me)))}}()},Ke=function(){var e=Y.scrollXLoad,t=B.visibleColumn,r=B.scrollXStore,l=B.fullColumnIdData,n=e?t.slice(r.startIndex,r.endIndex):t.slice(0);n.forEach(function(e,t){var r=e.id,n=l[r];n&&(n.$index=t)}),Y.tableColumn=n},Pe=function(){var e=Y.mergeList,t=Y.mergeFooterList,r=B.scrollXStore,n=r.startIndex,l=r.endIndex,o=r.offsetSize,i=Re(),a=i.toVisibleIndex,u=i.visibleSize,c={startIndex:Math.max(0,a-1-o),endIndex:a+u+o};Te(e.concat(t),c,"col");var s=c.startIndex,d=c.endIndex;(a<=n||l-u-1<=a)&&(n===s&&l===d||(r.startIndex=s,r.endIndex=d,Z.updateScrollXData())),G.closeTooltip()},Ye=function(){var i=[],a=[],u=[],e=Y.isGroup,t=Y.columnStore,r=m.value,n=B.collectColumn,l=B.tableFullColumn,o=B.scrollXStore,c=B.fullColumnIdData;if(e){var s=[],d=[],f=[];_xeUtils.default.eachTree(n,function(e,t,r,n,l){var o=(0,_utils.hasChildrenList)(e);l&&l.fixed&&(e.fixed=l.fixed),l&&e.fixed!==l.fixed&&(0,_utils.errLog)("vxe.error.groupFixed"),o?e.visible=!!_xeUtils.default.findTree(e.children,function(e){return!(0,_utils.hasChildrenList)(e)&&e.visible}):e.visible&&("left"===e.fixed?i.push(e):"right"===e.fixed?u.push(e):a.push(e))}),n.forEach(function(e){e.visible&&("left"===e.fixed?s.push(e):"right"===e.fixed?f.push(e):d.push(e))}),Y.tableGroupColumn=s.concat(d).concat(f)}else l.forEach(function(e){e.visible&&("left"===e.fixed?i.push(e):"right"===e.fixed?u.push(e):a.push(e))});var v=i.concat(a).concat(u),g=!!r.enabled&&-1<r.gt&&r.gt<l.length;if(Y.hasFixedColumn=0<i.length||0<u.length,Object.assign(t,{leftList:i,centerList:a,rightList:u}),g&&e&&(g=!1,"development"===process.env.NODE_ENV&&(0,_utils.warnLog)("vxe.error.scrollXNotGroup")),g){"development"===process.env.NODE_ENV&&(P.showHeader&&!P.showHeaderOverflow&&(0,_utils.warnLog)("vxe.error.reqProp",["show-header-overflow"]),P.showFooter&&!P.showFooterOverflow&&(0,_utils.warnLog)("vxe.error.reqProp",["show-footer-overflow"]),P.spanMethod&&(0,_utils.warnLog)("vxe.error.scrollErrProp",["span-method"]),P.footerSpanMethod&&(0,_utils.warnLog)("vxe.error.scrollErrProp",["footer-span-method"]));var h=Re().visibleSize;o.startIndex=0,o.endIndex=h,o.visibleSize=h}return v.length===B.visibleColumn.length&&B.visibleColumn.every(function(e,t){return e===v[t]})||(G.clearMergeCells(),G.clearMergeFooterItems()),Y.scrollXLoad=g,v.forEach(function(e,t){var r=e.id,n=c[r];n&&(n._index=t)}),B.visibleColumn=v,Ke(),G.updateFooter().then(function(){return G.recalculate()}).then(function(){return Z.updateCellAreas(),G.recalculate()})},Be=function(e){var d,f,v,g,h,t,r,x,m,n,l,p,i,o=function t(e){var r=[];return e.forEach(function(e){r.push.apply(r,e.children&&e.children.length?t(e.children):[e])}),r}(B.collectColumn=e);return B.tableFullColumn=o,t=B.tableFullColumn,r=B.collectColumn,x=B.fullColumnIdData={},m=B.fullColumnFieldData={},n=ue.value,l=r.some(_utils.hasChildrenList),p=!!P.showOverflow,i=function(e,t,r,n,l){var o=e.id,i=e.property,a=e.fixed,u=e.type,c=e.treeNode,s={column:e,colid:o,index:t,items:r,parent:l};i&&("development"===process.env.NODE_ENV&&m[i]&&(0,_utils.warnLog)("vxe.error.colRepet",["field",i]),m[i]=s),!h&&a&&(h=a),c?("development"===process.env.NODE_ENV&&f&&(0,_utils.warnLog)("vxe.error.colRepet",["tree-node",c]),f||(f=e)):"expand"===u&&("development"===process.env.NODE_ENV&&d&&(0,_utils.warnLog)("vxe.error.colRepet",["type",u]),d||(d=e)),"development"===process.env.NODE_ENV&&("checkbox"===u?(v&&(0,_utils.warnLog)("vxe.error.colRepet",["type",u]),v||(v=e)):"radio"===u&&(g&&(0,_utils.warnLog)("vxe.error.colRepet",["type",u]),g||(g=e))),p&&!1===e.showOverflow&&(p=!1),x[o]&&(0,_utils.errLog)("vxe.error.colRepet",["colId",o]),x[o]=s},l?_xeUtils.default.eachTree(r,function(e,t,r,n,l,o){e.level=o.length,i(e,t,r,0,l)}):t.forEach(i),"development"===process.env.NODE_ENV&&d&&n.area&&(0,_utils.errLog)("vxe.error.errConflicts",["mouse-config.area","column.type=expand"]),Y.isGroup=l,Y.treeNodeColumn=f,Y.expandColumn=d,Y.isAllOverflow=p,function(){var e=P.id,t=P.customConfig,r=B.collectColumn,n=U.value.storage,l=!0===n||n&&n.resizable,o=!0===n||n&&n.visible;if(t&&(l||o)){var i={};if(!e)return(0,_utils.errLog)("vxe.error.reqProp",["id"]);if(l){var a=be(resizableStorageKey)[e];a&&_xeUtils.default.each(a,function(e,t){i[t]={field:t,resizeWidth:e}})}if(o){var u=be(visibleStorageKey)[e];if(u){var c=u.split("|"),s=c[0]?c[0].split(","):[],d=c[1]?c[1].split(","):[];s.forEach(function(e){i[e]?i[e].visible=!1:i[e]={field:e,visible:!1}}),d.forEach(function(e){i[e]?i[e].visible=!0:i[e]={field:e,visible:!0}})}}var f={};_xeUtils.default.eachTree(r,function(e){var t=e.getKey();t&&(f[t]=e)}),_xeUtils.default.each(i,function(e,t){var r=e.visible,n=e.resizeWidth,l=f[t];l&&(_xeUtils.default.isNumber(n)&&(l.resizeWidth=n),_xeUtils.default.isBoolean(r)&&(l.visible=r))})}}(),Ye().then(function(){Y.scrollXLoad&&Pe()}),G.clearMergeCells(),G.clearMergeFooterItems(),Z.handleTableData(!0),"development"===process.env.NODE_ENV&&(Y.scrollXLoad||Y.scrollYLoad)&&Y.expandColumn&&(0,_utils.warnLog)("vxe.error.scrollErrProp",["column.type=expand"]),(0,_vue.nextTick)().then(function(){return _&&_.syncUpdate({collectColumn:e,$table:pe}),G.recalculate()})},Ge=function(e){var t=Y.mergeList,r=B.scrollYStore,n=r.startIndex,l=r.endIndex,o=r.visibleSize,i=r.offsetSize,a=r.rowHeight,u=(e.currentTarget||e.target).scrollTop,c=Math.floor(u/a),s={startIndex:Math.max(0,c-1-i),endIndex:c+o+i};Te(t,s,"row");var d=s.startIndex,f=s.endIndex;(c<=n||l-o-1<=c)&&(n===d&&l===f||(r.startIndex=d,r.endIndex=f,Z.updateScrollYData()))},Ze=_xeUtils.default.debounce(function(e){Ge(e)},20,{leading:!1,trailing:!0});G={dispatchEvent:function(e,t,r){n(e,Object.assign({$table:pe,$event:r},t))},clearAll:function(){return(0,_util.clearTableAllStatus)(pe)},syncData:function(){return(0,_vue.nextTick)().then(function(){return Y.tableData=[],n("update:data",B.tableFullData),(0,_vue.nextTick)()})},updateData:function(){return Z.handleTableData(!0).then(G.updateFooter).then(function(){return G.recalculate()})},loadData:function(e){var t=B.inited,r=B.initStatus;return Xe(e).then(function(){return B.inited=!0,B.initStatus=!0,r||je(),t||We(),G.recalculate()})},reloadData:function(e){var t=B.inited;return G.clearAll().then(function(){return B.inited=!0,B.initStatus=!0,Xe(e)}).then(function(){return je(),t||We(),G.recalculate()})},reloadRow:function(e,t,r){var n=P.keepSource,l=Y.tableData,o=B.tableSourceData;if(n){var i=G.getRowIndex(e),a=o[i];a&&e&&(r?_xeUtils.default.set(a,r,_xeUtils.default.get(t||e,r)):t?(o[i]=t,_xeUtils.default.clear(e,void 0),Object.assign(e,Z.defineField(Object.assign({},t))),Z.updateCache(!0)):_xeUtils.default.destructuring(a,_xeUtils.default.clone(e,!0))),Y.tableData=l.slice(0)}else"development"===process.env.NODE_ENV&&(0,_utils.warnLog)("vxe.error.reqProp",["keep-source"]);return(0,_vue.nextTick)()},loadChildren:function(c,e){return G.createData(e).then(function(e){var t=P.keepSource,a=B.fullDataRowIdData,u=B.fullAllDataRowIdData,r=B.tableSourceData,n=ve.value,l=n.children;if(t){var o=(0,_util.getRowid)(pe,c),i=_xeUtils.default.findTree(r,function(e){return o===(0,_util.getRowid)(pe,e)},n);i&&(i.item[l]=_xeUtils.default.clone(e,!0))}return _xeUtils.default.eachTree(e,function(e,t,r,n,l){var o=(0,_util.getRowid)(pe,e),i={row:e,rowid:o,index:-1,_index:-1,$index:-1,items:r,parent:l};a[o]=i,u[o]=i},n),c[l]=e})},loadColumn:function(e){var t=_xeUtils.default.mapTree(e,function(e){return(0,_vue.reactive)(_cell.default.createColumn(pe,e))});return Be(t)},reloadColumn:function(e){return G.clearAll().then(function(){return G.loadColumn(e)})},getRowNode:function(e){if(e){var t=B.fullAllDataRowIdData,r=e.getAttribute("rowid");if(r){var n=t[r];if(n)return{rowid:n.rowid,item:n.row,index:n.index,items:n.items,parent:n.parent}}}return null},getColumnNode:function(e){if(e){var t=B.fullColumnIdData,r=e.getAttribute("colid");if(r){var n=t[r];if(n)return{colid:n.colid,item:n.column,index:n.index,items:n.items,parent:n.parent}}}return null},getRowIndex:function(e){var t=B.fullDataRowIdData;if(e){var r=t[(0,_util.getRowid)(pe,e)];if(r)return r.index}return-1},getVTRowIndex:function(e){var t=B.fullDataRowIdData;if(e){var r=t[(0,_util.getRowid)(pe,e)];if(r)return r._index}return-1},getVMRowIndex:function(e){var t=B.fullDataRowIdData;if(e){var r=t[(0,_util.getRowid)(pe,e)];if(r)return r.$index}return-1},getColumnIndex:function(e){var t=B.fullColumnIdData;if(e){var r=t[e.id];if(r)return r.index}return-1},getVTColumnIndex:function(e){var t=B.fullColumnIdData;if(e){var r=t[e.id];if(r)return r._index}return-1},getVMColumnIndex:function(e){var t=B.fullColumnIdData;if(e){var r=t[e.id];if(r)return r.$index}return-1},createData:function(e){var t=P.treeConfig,r=ve.value,n=function(e){return(0,_vue.reactive)(Z.defineField(Object.assign({},e)))},l=t?_xeUtils.default.mapTree(e,n,r):e.map(n);return(0,_vue.nextTick)().then(function(){return l})},createRow:function(e){var t=_xeUtils.default.isArray(e);return t||(e=[e]),(0,_vue.nextTick)().then(function(){return G.createData(e).then(function(e){return t?e:e[0]})})},revertData:function(e,n){var t=P.keepSource,l=B.tableSourceData,o=B.tableFullData;if(!t)return"development"===process.env.NODE_ENV&&(0,_utils.warnLog)("vxe.error.reqProp",["keep-source"]),(0,_vue.nextTick)();var r=e;return e?_xeUtils.default.isArray(e)||(r=[e]):r=_xeUtils.default.toArray(pe.getUpdateRecords()),r.length&&r.forEach(function(e){if(!G.isInsertByRow(e)){var t=pe.findRowIndexOf(o,e),r=l[t];r&&e&&(n?_xeUtils.default.set(e,n,_xeUtils.default.clone(_xeUtils.default.get(r,n),!0)):_xeUtils.default.destructuring(e,_xeUtils.default.clone(r,!0)))}}),e?(0,_vue.nextTick)():G.reloadData(l)},clearData:function(e,t){var r=B.tableFullData,n=B.visibleColumn;return arguments.length?e&&!_xeUtils.default.isArray(e)&&(e=[e]):e=r,t?e.forEach(function(e){return _xeUtils.default.set(e,t,null)}):e.forEach(function(t){n.forEach(function(e){e.property&&(0,_util.setCellValue)(t,e,null)})}),(0,_vue.nextTick)()},isInsertByRow:function(e){var t=Y.editStore;return-1<pe.findRowIndexOf(t.insertList,e)},removeInsertRow:function(){var e=Y.editStore;return pe.remove(e.insertList)},isUpdateByRow:function(e,t){var r,n,l=P.keepSource,o=P.treeConfig,i=B.visibleColumn,a=B.tableSourceData,u=B.fullDataRowIdData,c=ve.value;if(l){var s=void 0,d=void 0,f=(0,_util.getRowid)(pe,e);if(!u[f])return!1;if(o){var v=c.children,g=_xeUtils.default.findTree(a,function(e){return f===(0,_util.getRowid)(pe,e)},c);e=Object.assign({},e,((r={})[v]=null,r)),g&&(s=Object.assign({},g.item,((n={})[v]=null,n)))}else{s=a[u[f].index]}if(s){if(1<arguments.length)return!_e(s,e,t);for(var h=0,x=i.length;h<x;h++)if((d=i[h].property)&&!_e(s,e,d))return!0}}return!1},getColumns:function(e){var t=B.visibleColumn;return _xeUtils.default.isUndefined(e)?t.slice(0):t[e]},getColumnById:function(e){var t=B.fullColumnIdData;return t[e]?t[e].column:null},getColumnByField:function(e){var t=B.fullColumnFieldData;return t[e]?t[e].column:null},getTableColumn:function(){return{collectColumn:B.collectColumn.slice(0),fullColumn:B.tableFullColumn.slice(0),visibleColumn:B.visibleColumn.slice(0),tableColumn:Y.tableColumn.slice(0)}},getData:function(e){var t=P.data||B.tableSynchData;return _xeUtils.default.isUndefined(e)?t.slice(0):t[e]},getCheckboxRecords:function(e){var t=P.treeConfig,r=B.tableFullData,n=B.afterFullData,l=ve.value,o=R.value.checkField,i=[],a=e?r:n;if(o)i=t?_xeUtils.default.filterTree(a,function(e){return _xeUtils.default.get(e,o)},l):a.filter(function(e){return _xeUtils.default.get(e,o)});else{var u=Y.selection;i=t?_xeUtils.default.filterTree(a,function(e){return-1<pe.findRowIndexOf(u,e)},l):a.filter(function(e){return-1<pe.findRowIndexOf(u,e)})}return i},getRowById:function(e){var t=B.fullDataRowIdData;return t[e]?t[e].row:null},getRowid:function(e){return(0,_util.getRowid)(pe,e)},getTableData:function(){var e=Y.tableData,t=Y.footerTableData,r=B.tableFullData,n=B.afterFullData;return{fullData:r.slice(0),visibleData:n.slice(0),tableData:e.slice(0),footerData:t.slice(0)}},hideColumn:function(e){var t=(0,_util.handleFieldOrColumn)(pe,e);return t&&(t.visible=!1),Z.handleCustom()},showColumn:function(e){var t=(0,_util.handleFieldOrColumn)(pe,e);return t&&(t.visible=!0),Z.handleCustom()},resetColumn:function(e){var t=B.tableFullColumn,r=U.value.checkMethod,n=Object.assign({visible:!0,resizable:!0===e},e);return t.forEach(function(e){n.resizable&&(e.resizeWidth=0),r&&!r({column:e})||(e.visible=e.defaultVisible)}),n.resizable&&Z.saveCustomResizable(!0),Z.handleCustom()},refreshColumn:function(){return Ye().then(function(){return G.refreshScroll()}).then(function(){return G.recalculate()})},refreshScroll:function(){var e=B.lastScrollLeft,t=B.lastScrollTop,r=K.value,n=J.value,l=d.value,o=g.value,i=r?r.$el:null,a=l?l.$el:null,u=o?o.$el:null,c=n?n.$el:null;return e||t?(0,_util.restoreScrollLocation)(pe,e,t):((0,_dom.setScrollTop)(i,t),(0,_dom.setScrollTop)(a,t),(0,_dom.setScrollTop)(u,t),(0,_dom.setScrollLeft)(c,e),(0,_vue.nextTick)())},recalculate:function(e){var t=W.value,r=K.value,n=J.value,l=r?r.$el:null,o=t?t.$el:null,i=n?n.$el:null;return l&&(Le(o,l,i),!0===e)?$e().then(function(){return Le(o,l,i),$e()}):$e()},openTooltip:function(e,t){var r=q.value;return r?r.open(e,t):(0,_vue.nextTick)()},closeTooltip:function(){var e=B.tooltipStore,t=H.value,r=q.value;return e.visible&&(Object.assign(e,{row:null,column:null,content:null,visible:!1}),t&&t.close()),r&&r.close(),(0,_vue.nextTick)()},isAllCheckboxChecked:function(){return Y.isAllSelected},isAllCheckboxIndeterminate:function(){return!Y.isAllSelected&&Y.isIndeterminate},getCheckboxIndeterminateRecords:function(e){var t=P.treeConfig,r=B.afterFullData,n=Y.treeIndeterminates;return t?e?n.slice(0):n.filter(function(e){return-1<pe.findRowIndexOf(r,e)}):[]},setCheckboxRow:function(e,t){return e&&!_xeUtils.default.isArray(e)&&(e=[e]),e.forEach(function(e){return Z.handleSelectRow({row:e},!!t)}),(0,_vue.nextTick)()},isCheckedByCheckboxRow:function(e){var t=Y.selection,r=R.value.checkField;return r?_xeUtils.default.get(e,r):-1<pe.findRowIndexOf(t,e)},isIndeterminateByCheckboxRow:function(e){var t=Y.treeIndeterminates;return-1<pe.findRowIndexOf(t,e)&&!G.isCheckedByCheckboxRow(e)},toggleCheckboxRow:function(e){return Z.handleToggleCheckRowEvent(null,{row:e}),(0,_vue.nextTick)()},setAllCheckboxRow:function(t){var e=P.treeConfig,r=Y.selection,n=B.afterFullData,l=B.checkboxReserveRowMap,o=ve.value,i=R.value,a=i.checkField,u=i.reserve,c=i.checkStrictly,s=i.checkMethod,d=[],f=e?[]:r.filter(function(e){return-1===pe.findRowIndexOf(n,e)});if(c)Y.isAllSelected=t;else{if(a){var v=function(e){s&&!s({row:e})||(t&&d.push(e),_xeUtils.default.set(e,a,t))};e?_xeUtils.default.eachTree(n,v,o):n.forEach(v)}else e?t?_xeUtils.default.eachTree(n,function(e){s&&!s({row:e})||d.push(e)},o):s&&_xeUtils.default.eachTree(n,function(e){!s({row:e})&&-1<pe.findRowIndexOf(r,e)&&d.push(e)},o):t?d=s?n.filter(function(e){return-1<pe.findRowIndexOf(r,e)||s({row:e})}):n.slice(0):s&&(d=n.filter(function(e){return s({row:e})?0:-1<pe.findRowIndexOf(r,e)}));u&&(t?d.forEach(function(e){l[(0,_util.getRowid)(pe,e)]=e}):n.forEach(function(e){return Ne(e,!1)})),Y.selection=a?[]:f.concat(d)}return Y.treeIndeterminates=[],Z.checkSelectionStatus(),(0,_vue.nextTick)()},getRadioReserveRecord:function(e){var t=P.treeConfig,r=B.fullDataRowIdData,n=B.radioReserveRow,l=B.afterFullData,o=E.value,i=ve.value;if(o.reserve&&n){var a=(0,_util.getRowid)(pe,n);if(e){if(!r[a])return n}else{var u=(0,_util.getRowkey)(pe);if(t){if(_xeUtils.default.findTree(l,function(e){return a===_xeUtils.default.get(e,u)},i))return n}else if(!l.some(function(e){return a===_xeUtils.default.get(e,u)}))return n}}return null},clearRadioReserve:function(){return B.radioReserveRow=null,(0,_vue.nextTick)()},getCheckboxReserveRecords:function(r){var n=P.treeConfig,l=B.afterFullData,o=B.fullDataRowIdData,e=B.checkboxReserveRowMap,t=R.value,i=ve.value,a=[];return t.reserve&&_xeUtils.default.each(e,function(e,t){e&&(r?o[t]||a.push(e):n?_xeUtils.default.findTree(l,function(e){return(0,_util.getRowid)(pe,e)===t},i)||a.push(e):l.some(function(e){return(0,_util.getRowid)(pe,e)===t})||a.push(e))}),a},clearCheckboxReserve:function(){return B.checkboxReserveRowMap={},(0,_vue.nextTick)()},toggleAllCheckboxRow:function(){return Z.triggerCheckAllEvent(null,!Y.isAllSelected),(0,_vue.nextTick)()},clearCheckboxRow:function(){var e=P.treeConfig,t=B.tableFullData,r=ve.value,n=R.value,l=n.checkField,o=n.reserve;return l&&(e?_xeUtils.default.eachTree(t,function(e){return _xeUtils.default.set(e,l,!1)},r):t.forEach(function(e){return _xeUtils.default.set(e,l,!1)})),o&&t.forEach(function(e){return Ne(e,!1)}),Y.isAllSelected=!1,Y.isIndeterminate=!1,Y.selection=[],Y.treeIndeterminates=[],(0,_vue.nextTick)()},setCurrentRow:function(e){var t=z.value;return G.clearCurrentRow(),G.clearCurrentColumn(),Y.currentRow=e,P.highlightCurrentRow&&t&&_xeUtils.default.arrayEach(t.querySelectorAll('[rowid="'+(0,_util.getRowid)(pe,e)+'"]'),function(e){return(0,_dom.addClass)(e,"row--current")}),(0,_vue.nextTick)()},isCheckedByRadioRow:function(e){return Y.selectRow===e},setRadioRow:function(e){var t,r=E.value.checkMethod;return!e||r&&!r({row:e})||(Y.selectRow=e,t=e,E.value.reserve&&(B.radioReserveRow=t)),(0,_vue.nextTick)()},clearCurrentRow:function(){var e=z.value;return Y.currentRow=null,B.hoverRow=null,e&&_xeUtils.default.arrayEach(e.querySelectorAll(".row--current"),function(e){return(0,_dom.removeClass)(e,"row--current")}),(0,_vue.nextTick)()},clearRadioRow:function(){return Y.selectRow=null,(0,_vue.nextTick)()},getCurrentRecord:function(){return P.highlightCurrentRow?Y.currentRow:null},getRadioRecord:function(e){var t=P.treeConfig,r=B.fullDataRowIdData,n=B.afterFullData,l=Y.selectRow,o=ve.value;if(l){var i=(0,_util.getRowid)(pe,l);if(e){if(!r[i])return l}else if(t){var a=(0,_util.getRowkey)(pe);if(_xeUtils.default.findTree(n,function(e){return i===_xeUtils.default.get(e,a)},o))return l}else if(-1<n.indexOf(l))return l}return null},getCurrentColumn:function(){return P.highlightCurrentColumn?Y.currentColumn:null},setCurrentColumn:function(e){var t=(0,_util.handleFieldOrColumn)(pe,e);return t&&(G.clearCurrentRow(),G.clearCurrentColumn(),Y.currentColumn=t),(0,_vue.nextTick)()},clearCurrentColumn:function(){return Y.currentColumn=null,(0,_vue.nextTick)()},sort:function(e,t){var r=C.value,n=r.multiple,l=r.remote,o=r.orders;return e&&_xeUtils.default.isString(e)&&(e=[{field:e,order:t}]),_xeUtils.default.isArray(e)||(e=[e]),e.length?(n||Ie(),(n?e:[e[0]]).forEach(function(e){var t=e.field,r=e.order,n=t;_xeUtils.default.isString(t)&&(n=G.getColumnByField(t)),n&&n.sortable&&(-1===o.indexOf(r)&&(r=we(n)),n.order!==r&&(n.order=r),n.sortTime=Date.now())}),l||Z.handleTableData(!0),(0,_vue.nextTick)().then(Me)):(0,_vue.nextTick)()},clearSort:function(e){var t=C.value;if(e){var r=(0,_util.handleFieldOrColumn)(pe,e);r&&(r.order=null)}else Ie();return t.remote||Z.handleTableData(!0),(0,_vue.nextTick)().then(Me)},isSort:function(e){if(e){var t=(0,_util.handleFieldOrColumn)(pe,e);return!!t&&(t.sortable&&!!t.order)}return 0<G.getSortColumns().length},getSortColumns:function(){var r=[];return B.tableFullColumn.forEach(function(e){var t=e.order;e.sortable&&t&&r.push({column:e,property:e.property,order:t})}),r},closeFilter:function(){var e=Y.filterStore;return Object.assign(e,{isAllSelected:!1,isIndeterminate:!1,options:[],visible:!1}),(0,_vue.nextTick)()},isFilter:function(e){var t=(0,_util.handleFieldOrColumn)(pe,e);return t?t.filters&&t.filters.some(function(e){return e.checked}):0<pe.getCheckedFilters().length},isRowExpandLoaded:function(e){var t=B.fullAllDataRowIdData[(0,_util.getRowid)(pe,e)];return t&&!!t.expandLoaded},clearRowExpandLoaded:function(t){var e=Y.expandLazyLoadeds,r=B.fullAllDataRowIdData,n=L.value.lazy,l=r[(0,_util.getRowid)(pe,t)];return n&&l&&(l.expandLoaded=!1,_xeUtils.default.remove(e,function(e){return pe.eqRow(e,t)})),(0,_vue.nextTick)()},reloadExpandContent:function(e){var t=Y.expandLazyLoadeds;return L.value.lazy&&-1===pe.findRowIndexOf(t,e)&&G.clearRowExpandLoaded(e).then(function(){return He(e)}),(0,_vue.nextTick)()},toggleRowExpand:function(e){return G.setRowExpand(e,!G.isExpandByRow(e))},setAllRowExpand:function(e){var t=L.value;return G.setRowExpand(t.lazy?Y.tableData:B.tableFullData,e)},setRowExpand:function(e,t){var r=Y.rowExpandeds,n=Y.expandLazyLoadeds,l=Y.expandColumn,o=B.fullAllDataRowIdData,i=L.value,a=i.reserve,u=i.lazy,c=i.accordion,s=i.toggleMethod,d=[],f=G.getColumnIndex(l),v=G.getVMColumnIndex(l);if(e){_xeUtils.default.isArray(e)||(e=[e]),c&&(r=[],e=e.slice(e.length-1,e.length));var g=s?e.filter(function(e){return s({$table:pe,expanded:t,column:l,columnIndex:f,$columnIndex:v,row:e,rowIndex:G.getRowIndex(e),$rowIndex:G.getVMRowIndex(e)})}):e;t?g.forEach(function(e){if(-1===pe.findRowIndexOf(r,e)){var t=o[(0,_util.getRowid)(pe,e)];u&&!t.expandLoaded&&-1===pe.findRowIndexOf(n,e)?d.push(He(e)):r.push(e)}}):_xeUtils.default.remove(r,function(e){return-1<pe.findRowIndexOf(g,e)}),a&&g.forEach(function(e){return qe(e,t)})}return Y.rowExpandeds=r,Promise.all(d).then(function(){return G.recalculate()})},isExpandByRow:function(e){var t=Y.rowExpandeds;return-1<pe.findRowIndexOf(t,e)},clearRowExpand:function(){var e=Y.rowExpandeds,t=B.tableFullData,r=L.value.reserve,n=e.length;return Y.rowExpandeds=[],r&&t.forEach(function(e){return qe(e,!1)}),(0,_vue.nextTick)().then(function(){n&&G.recalculate()})},clearRowExpandReserve:function(){return B.rowExpandedReserveRowMap={},(0,_vue.nextTick)()},getRowExpandRecords:function(){return Y.rowExpandeds.slice(0)},getTreeExpandRecords:function(){return Y.treeExpandeds.slice(0)},isTreeExpandLoaded:function(e){var t=B.fullAllDataRowIdData[(0,_util.getRowid)(pe,e)];return t&&!!t.treeLoaded},clearTreeExpandLoaded:function(t){var e=Y.treeExpandeds,r=B.fullAllDataRowIdData,n=ve.value.lazy,l=r[(0,_util.getRowid)(pe,t)];return n&&l&&(l.treeLoaded=!1,_xeUtils.default.remove(e,function(e){return pe.eqRow(e,t)})),(0,_vue.nextTick)()},reloadTreeChilds:function(e){var t=Y.treeLazyLoadeds,r=ve.value,n=r.lazy,l=r.hasChild;return n&&e[l]&&-1===pe.findRowIndexOf(t,e)&&G.clearTreeExpandLoaded(e).then(function(){return Ve(e)}),(0,_vue.nextTick)()},toggleTreeExpand:function(e){return G.setTreeExpand(e,!G.isTreeExpandByRow(e))},setAllTreeExpand:function(e){var t=B.tableFullData,r=ve.value,n=r.lazy,l=r.children,o=[];return _xeUtils.default.eachTree(t,function(e){var t=e[l];(n||t&&t.length)&&o.push(e)},r),G.setTreeExpand(o,e)},setTreeExpand:function(e,t){var r=Y.treeExpandeds,n=Y.treeLazyLoadeds,l=Y.treeNodeColumn,o=B.fullAllDataRowIdData,i=B.tableFullData,a=ve.value,u=a.reserve,c=a.lazy,s=a.hasChild,d=a.children,f=a.accordion,v=a.toggleMethod,g=[],h=G.getColumnIndex(l),x=G.getVMColumnIndex(l);if(e&&(_xeUtils.default.isArray(e)||(e=[e]),e.length)){var m=v?e.filter(function(e){return v({$table:pe,expanded:t,column:l,columnIndex:h,$columnIndex:x,row:e})}):e;if(f){m=m.length?[m[m.length-1]]:[];var p=_xeUtils.default.findTree(i,function(e){return e===m[0]},a);p&&_xeUtils.default.remove(r,function(e){return-1<p.items.indexOf(e)})}return t?m.forEach(function(e){if(-1===pe.findRowIndexOf(r,e)){var t=o[(0,_util.getRowid)(pe,e)];c&&e[s]&&!t.treeLoaded&&-1===pe.findRowIndexOf(n,e)?g.push(Ve(e)):e[d]&&e[d].length&&r.push(e)}}):_xeUtils.default.remove(r,function(e){return-1<pe.findRowIndexOf(m,e)}),u&&m.forEach(function(e){return ze(e,t)}),Promise.all(g).then(function(){return G.recalculate()})}return(0,_vue.nextTick)()},isTreeExpandByRow:function(e){var t=Y.treeExpandeds;return-1<pe.findRowIndexOf(t,e)},clearTreeExpand:function(){var e=Y.treeExpandeds,t=B.tableFullData,r=ve.value,n=r.reserve,l=e.length;return Y.treeExpandeds=[],n&&_xeUtils.default.eachTree(t,function(e){return ze(e,!1)},r),(0,_vue.nextTick)().then(function(){l&&G.recalculate()})},clearTreeExpandReserve:function(){return B.treeExpandedReserveRowMap={},(0,_vue.nextTick)()},getScroll:function(){var e=Y.scrollXLoad,t=Y.scrollYLoad,r=K.value.$el;return{virtualX:e,virtualY:t,scrollTop:r.scrollTop,scrollLeft:r.scrollLeft}},scrollTo:function(e,t){var r=K.value,n=J.value,l=g.value,o=r?r.$el:null,i=l?l.$el:null,a=n?n.$el:null;return _xeUtils.default.isNumber(e)&&(0,_dom.setScrollLeft)(a||o,e),_xeUtils.default.isNumber(t)&&(0,_dom.setScrollTop)(i||o,t),Y.scrollXLoad||Y.scrollYLoad?new Promise(function(e){return setTimeout(function(){return e((0,_vue.nextTick)())},50)}):(0,_vue.nextTick)()},scrollToRow:function(e,t){var r=[];return e&&(P.treeConfig?r.push(Z.scrollToTreeRow(e)):r.push((0,_util.rowToVisible)(pe,e))),t&&r.push(G.scrollToColumn(t)),Promise.all(r)},scrollToColumn:function(e){var t=B.fullColumnIdData,r=(0,_util.handleFieldOrColumn)(pe,e);return r&&t[r.id]?(0,_util.colToVisible)(pe,r):(0,_vue.nextTick)()},clearScroll:function(){var e=B.scrollXStore,t=B.scrollYStore,r=K.value,n=J.value,l=g.value,o=r?r.$el:null,i=l?l.$el:null,a=n?n.$el:null;return i&&((0,_util.restoreScrollListener)(i),i.scrollTop=0),a&&(a.scrollLeft=0),o&&((0,_util.restoreScrollListener)(o),o.scrollTop=0,o.scrollLeft=0),e.startIndex=0,(t.startIndex=0,_vue.nextTick)()},updateFooter:function(){var e=P.showFooter,t=P.footerMethod,r=B.visibleColumn,n=B.afterFullData;return e&&t&&(Y.footerTableData=r.length?t({columns:r,data:n,$table:pe,$grid:x}):[]),(0,_vue.nextTick)()},updateStatus:function(i,a){var u=!_xeUtils.default.isUndefined(a);return(0,_vue.nextTick)().then(function(){var e=P.editRules,t=Y.validStore,r=K.value;if(i&&r&&e){var n=i.row,l=i.column;if(pe.hasCellRules&&pe.hasCellRules("change",n,l)){var o=Z.getCell(n,l);if(o)return pe.validCellRules("change",n,l,a).then(function(){u&&t.visible&&(0,_util.setCellValue)(n,l,a),pe.clearValidate()}).catch(function(e){var t=e.rule;u&&(0,_util.setCellValue)(n,l,a),pe.showValidTooltip({rule:t,row:n,column:l,cell:o})})}}})},setMergeCells:function(e){return P.spanMethod&&(0,_utils.errLog)("vxe.error.errConflicts",["merge-cells","span-method"]),ye(e,Y.mergeList,B.afterFullData),(0,_vue.nextTick)().then(function(){return Z.updateCellAreas()})},removeMergeCells:function(e){P.spanMethod&&(0,_utils.errLog)("vxe.error.errConflicts",["merge-cells","span-method"]);var t=Se(e,Y.mergeList,B.afterFullData);return(0,_vue.nextTick)().then(function(){return Z.updateCellAreas(),t})},getMergeCells:function(){return Y.mergeList.slice(0)},clearMergeCells:function(){return Y.mergeList=[],(0,_vue.nextTick)()},setMergeFooterItems:function(e){return P.footerSpanMethod&&(0,_utils.errLog)("vxe.error.errConflicts",["merge-footer-items","footer-span-method"]),ye(e,Y.mergeFooterList),(0,_vue.nextTick)().then(function(){return Z.updateCellAreas()})},removeMergeFooterItems:function(e){P.footerSpanMethod&&(0,_utils.errLog)("vxe.error.errConflicts",["merge-footer-items","footer-span-method"]);var t=Se(e,Y.mergeFooterList);return(0,_vue.nextTick)().then(function(){return Z.updateCellAreas(),t})},getMergeFooterItems:function(){return Y.mergeFooterList.slice(0)},clearMergeFooterItems:function(){return Y.mergeFooterList=[],(0,_vue.nextTick)()},focus:function(){return B.isActivated=!0,(0,_vue.nextTick)()},blur:function(){return B.isActivated=!1,(0,_vue.nextTick)()},connect:function(e){return e?(_=e).syncUpdate({collectColumn:B.collectColumn,$table:pe}):(0,_utils.errLog)("vxe.error.barUnableLink"),(0,_vue.nextTick)()}};var Je=function(l){var e=Y.editStore,t=Y.ctxMenuStore,r=Y.filterStore,n=P.mouseConfig,o=z.value,i=ae.value,a=e.actived,u=$.value,c=X.value,s=j.value;if(c&&((0,_dom.getEventTargetNode)(l,o,"vxe-cell--filter").flag||(0,_dom.getEventTargetNode)(l,c.$el).flag||(0,_dom.getEventTargetNode)(l,document.body,"vxe-table--ignore-clear").flag||Z.preventEvent(l,"event.clearFilter",r.args,G.closeFilter)),a.row){if(!1!==i.autoClear){var d=a.args.cell;d&&(0,_dom.getEventTargetNode)(l,d).flag||u&&(0,_dom.getEventTargetNode)(l,u.$el).flag||(!B._lastCallTime||B._lastCallTime+50<Date.now())&&((0,_dom.getEventTargetNode)(l,document.body,"vxe-table--ignore-clear").flag||Z.preventEvent(l,"event.clearActived",a.args,function(){var e;if("row"===i.mode){var t=(0,_dom.getEventTargetNode)(l,o,"vxe-body--row"),r=t.flag?G.getRowNode(t.targetElem):null;e=!!r&&!pe.eqRow(r.item,a.args.row)}else e=!(0,_dom.getEventTargetNode)(l,o,"col--edit").flag;if(e||(e=(0,_dom.getEventTargetNode)(l,o,"vxe-header--row").flag),e||(e=(0,_dom.getEventTargetNode)(l,o,"vxe-footer--row").flag),!e&&P.height&&!Y.overflowY){var n=l.target;(0,_dom.hasClass)(n,"vxe-table--body-wrapper")&&(e=l.offsetY<n.clientHeight)}!e&&(0,_dom.getEventTargetNode)(l,o).flag||setTimeout(function(){return pe.clearActived(l)})}))}}else n&&((0,_dom.getEventTargetNode)(l,o).flag||x&&(0,_dom.getEventTargetNode)(l,x.getRefMaps().refElem.value).flag||s&&(0,_dom.getEventTargetNode)(l,s.getRefMaps().refElem.value).flag||_&&(0,_dom.getEventTargetNode)(l,_.getRefMaps().refElem.value).flag||(pe.clearSelected(),pe.clearCellAreas&&((0,_dom.getEventTargetNode)(l,document.body,"vxe-table--ignore-areas-clear").flag||Z.preventEvent(l,"event.clearAreas",{},function(){pe.clearCellAreas(),pe.clearCopyCellArea()}))));pe.closeMenu&&t.visible&&s&&!(0,_dom.getEventTargetNode)(l,s.getRefMaps().refElem.value).flag&&pe.closeMenu(),B.isActivated=(0,_dom.getEventTargetNode)(l,x?x.getRefMaps().refElem.value:o).flag},Qe=function(){G.closeFilter(),pe.closeMenu&&pe.closeMenu()},et=function(){G.closeTooltip(),pe.closeMenu&&pe.closeMenu()},tt=function(t){var r=P.mouseConfig,n=P.keyboardConfig,l=Y.filterStore,o=Y.ctxMenuStore,e=Y.editStore,i=ue.value,a=e.actived;(0,_event.hasEventKey)(t,_event.EVENT_KEYS.ESCAPE)&&Z.preventEvent(t,"event.keydown",null,function(){if(n&&r&&i.area&&pe.handleKeyboardEvent)pe.handleKeyboardEvent(t);else if((a.row||l.visible||o.visible)&&(t.stopPropagation(),pe.closeMenu&&pe.closeMenu(),G.closeFilter(),a.row)){var e=a.args;pe.clearActived(t),i.selected&&(0,_vue.nextTick)(function(){return pe.handleSelected(e,t)})}G.dispatchEvent("keydown",{},t)})},rt=function(K){B.isActivated&&Z.preventEvent(K,"event.keydown",null,function(){var e,t=P.mouseConfig,r=P.keyboardConfig,n=P.treeConfig,l=P.editConfig,o=P.highlightCurrentRow,i=Y.ctxMenuStore,a=Y.editStore,u=Y.currentRow,c=de.value,s=se.value,d=ce.value,f=ue.value,v=ae.value,g=ve.value,h=fe.value,x=a.selected,m=a.actived,p=K.keyCode,_=(0,_event.hasEventKey)(K,_event.EVENT_KEYS.ESCAPE),w=(0,_event.hasEventKey)(K,_event.EVENT_KEYS.BACKSPACE),b=(0,_event.hasEventKey)(K,_event.EVENT_KEYS.TAB),C=(0,_event.hasEventKey)(K,_event.EVENT_KEYS.ENTER),E=(0,_event.hasEventKey)(K,_event.EVENT_KEYS.SPACEBAR),R=(0,_event.hasEventKey)(K,_event.EVENT_KEYS.ARROW_LEFT),T=(0,_event.hasEventKey)(K,_event.EVENT_KEYS.ARROW_UP),y=(0,_event.hasEventKey)(K,_event.EVENT_KEYS.ARROW_RIGHT),S=(0,_event.hasEventKey)(K,_event.EVENT_KEYS.ARROW_DOWN),I=(0,_event.hasEventKey)(K,_event.EVENT_KEYS.DELETE),D=(0,_event.hasEventKey)(K,_event.EVENT_KEYS.F2),k=(0,_event.hasEventKey)(K,_event.EVENT_KEYS.CONTEXT_MENU),L=K.metaKey,U=K.ctrlKey,O=K.shiftKey,M=K.altKey,A=R||T||y||S,F=c&&i.visible&&(C||E||A),N=(0,_utils.isEnableConf)(l)&&m.column&&m.row;if(F)K.preventDefault(),i.showChild&&(0,_utils.hasChildrenList)(i.selected)?pe.moveCtxMenu(K,i,"selectChild",R,!1,i.selected.children):pe.moveCtxMenu(K,i,"selected",y,!0,h);else if(r&&t&&f.area&&pe.handleKeyboardEvent)pe.handleKeyboardEvent(K);else if(_){if(pe.closeMenu&&pe.closeMenu(),G.closeFilter(),m.row&&m.row){var V=m.args;pe.clearActived(K),f.selected&&(0,_vue.nextTick)(function(){return pe.handleSelected(V,K)})}}else if(E&&r&&d.isChecked&&x.row&&x.column&&("checkbox"===x.column.type||"radio"===x.column.type))K.preventDefault(),"checkbox"===x.column.type?Z.handleToggleCheckRowEvent(K,x.args):Z.triggerRadioRowEvent(K,x.args);else if(D&&(0,_utils.isEnableConf)(l))N||x.row&&x.column&&(K.preventDefault(),pe.handleActived(x.args,K));else if(k)B._keyCtx=x.row&&x.column&&s.length,clearTimeout(oe),oe=setTimeout(function(){B._keyCtx=!1},1e3);else if(C&&!M&&r&&d.isEnter&&(x.row||m.row||n&&o&&u)){if(U)m.row&&(e=m.args,pe.clearActived(K),f.selected&&(0,_vue.nextTick)(function(){return pe.handleSelected(e,K)}));else if(x.row||m.row){var z=x.row?x.args:m.args;O?d.enterToTab?pe.moveTabSelected(z,O,K):pe.moveSelected(z,R,!0,y,!1,K):d.enterToTab?pe.moveTabSelected(z,O,K):pe.moveSelected(z,R,!1,y,!0,K)}else if(n&&o&&u){var H=u[g.children];if(H&&H.length){K.preventDefault();var q=H[0];e={$table:pe,row:q,rowIndex:G.getRowIndex(q),$rowIndex:G.getVMRowIndex(q)},G.setTreeExpand(u,!0).then(function(){return G.scrollToRow(q)}).then(function(){return Z.triggerCurrentRowEvent(K,e)})}}}else if(A&&r&&d.isArrow)N||(x.row&&x.column?pe.moveSelected(x.args,R,T,y,S,K):(T||S)&&o&&pe.moveCurrentRow(T,S,K));else if(b&&r&&d.isTab)x.row||x.column?pe.moveTabSelected(x.args,O,K):(m.row||m.column)&&pe.moveTabSelected(m.args,O,K);else if(r&&(0,_utils.isEnableConf)(l)&&(I||(n&&o&&u?w&&d.isArrow:w))){if(!N){var $=d.delMethod,X=d.backMethod;if(d.isDel&&(x.row||x.column))$?$({row:x.row,rowIndex:G.getRowIndex(x.row),column:x.column,columnIndex:G.getColumnIndex(x.column),$table:pe}):(0,_util.setCellValue)(x.row,x.column,null),w?X?X({row:x.row,rowIndex:G.getRowIndex(x.row),column:x.column,columnIndex:G.getColumnIndex(x.column),$table:pe}):pe.handleActived(x.args,K):I&&G.updateFooter();else if(w&&d.isArrow&&n&&o&&u){var j=_xeUtils.default.findTree(B.afterFullData,function(e){return e===u},g).parent;j&&(K.preventDefault(),e={$table:pe,row:j,rowIndex:G.getRowIndex(j),$rowIndex:G.getVMRowIndex(j)},G.setTreeExpand(j,!1).then(function(){return G.scrollToRow(j)}).then(function(){return Z.triggerCurrentRowEvent(K,e)}))}}}else if(r&&(0,_utils.isEnableConf)(l)&&d.isEdit&&!U&&!L&&(E||48<=p&&p<=57||65<=p&&p<=90||96<=p&&p<=111||186<=p&&p<=192||219<=p&&p<=222)){var W=d.editMethod;x.column&&x.row&&(0,_utils.isEnableConf)(x.column.editRender)&&(v.activeMethod&&!v.activeMethod(x.args)||(W?W({row:x.row,rowIndex:G.getRowIndex(x.row),column:x.column,columnIndex:G.getColumnIndex(x.column),$table:pe}):((0,_util.setCellValue)(x.row,x.column,null),pe.handleActived(x.args,K))))}G.dispatchEvent("keydown",{},K)})},nt=function(e){var t=P.keyboardConfig,r=P.mouseConfig,n=Y.editStore,l=Y.filterStore,o=B.isActivated,i=ue.value,a=ce.value,u=n.actived;o&&!l.visible&&(u.row||u.column||t&&a.isClip&&r&&i.area&&pe.handlePasteCellAreaEvent&&pe.handlePasteCellAreaEvent(e),G.dispatchEvent("paste",{},e))},lt=function(e){var t=P.keyboardConfig,r=P.mouseConfig,n=Y.editStore,l=Y.filterStore,o=B.isActivated,i=ue.value,a=ce.value,u=n.actived;o&&!l.visible&&(u.row||u.column||t&&a.isClip&&r&&i.area&&pe.handleCopyCellAreaEvent&&pe.handleCopyCellAreaEvent(e),G.dispatchEvent("copy",{},e))},ot=function(e){var t=P.keyboardConfig,r=P.mouseConfig,n=Y.editStore,l=Y.filterStore,o=B.isActivated,i=ue.value,a=ce.value,u=n.actived;o&&!l.visible&&(u.row||u.column||t&&a.isClip&&r&&i.area&&pe.handleCutCellAreaEvent&&pe.handleCutCellAreaEvent(e),G.dispatchEvent("cut",{},e))},it=function(){pe.closeMenu&&pe.closeMenu(),Z.updateCellAreas(),G.recalculate(!0)},at=function(){clearTimeout(B.tooltipTimeout),B.tooltipActive=!0,G.closeTooltip()},ut=function(e,t,r,n,l){l.cell=t;var o=B.tooltipStore,i=le.value,a=l.column,u=l.row,c=i.showAll,s=i.contentMethod,d=H.value,f=s?s(l):null,v=s&&!_xeUtils.default.eqNull(f),g=v?f:("html"===a.type?r.innerText:r.textContent).trim(),h=r.scrollWidth>r.clientWidth;return g&&(c||v||h)&&(Object.assign(o,{row:u,column:a,visible:!0}),d&&d.open(h?r:n||r,(0,_utils.formatText)(g))),(0,_vue.nextTick)()};Z={updateAfterDataIndex:Ue,callSlot:function(e,t){if(e){if(x)return x.callSlot(e,t);if(_xeUtils.default.isFunction(e))return e(t)}return[]},getParentElem:function(){var e=z.value;if(x){var t=x.getRefMaps().refElem.value;return t?t.parentNode:null}return e?e.parentNode:null},getParentHeight:function(){var e=P.height,t=z.value;if(t){var r=t.parentNode,n="auto"===e?(0,_dom.getPaddingTopBottomSize)(r):0;return Math.floor(x?x.getParentHeight():_xeUtils.default.toNumber(getComputedStyle(r).height)-n)}return 0},getExcludeHeight:function(){return x?x.getExcludeHeight():0},defineField:function(o){var e=P.treeConfig,t=L.value,r=ve.value,n=E.value,l=R.value,i=(0,_util.getRowkey)(pe);return B.tableFullColumn.forEach(function(e){var t=e.property,r=e.editRender;if(t&&!_xeUtils.default.has(o,t)){var n=null;if(r){var l=r.defaultValue;_xeUtils.default.isFunction(l)?n=l({column:e}):_xeUtils.default.isUndefined(l)||(n=l)}_xeUtils.default.set(o,t,n)}}),[n.labelField,l.checkField,l.labelField,t.labelField].forEach(function(e){e&&(0,_utils.eqEmptyValue)(_xeUtils.default.get(o,e))&&_xeUtils.default.set(o,e,null)}),e&&r.lazy&&_xeUtils.default.isUndefined(o[r.children])&&(o[r.children]=null),(0,_utils.eqEmptyValue)(_xeUtils.default.get(o,i))&&_xeUtils.default.set(o,i,(0,_util.getRowUniqueId)()),o},handleTableData:function(e){var t=Y.scrollYLoad,r=B.scrollYStore,l=B.fullDataRowIdData,n=e?Oe():B.afterFullData,o=t?n.slice(r.startIndex,r.endIndex):n.slice(0);return o.forEach(function(e,t){var r=(0,_util.getRowid)(pe,e),n=l[r];n&&(n.$index=t)}),Y.tableData=o,(0,_vue.nextTick)()},updateCache:function(a){var u=P.treeConfig,c=ve.value,s=B.fullDataRowIdData,d=B.fullAllDataRowIdData,e=B.tableFullData,f=(0,_util.getRowkey)(pe),v=u&&c.lazy,t=function(e,t,r,n,l){var o=(0,_util.getRowid)(pe,e);(0,_utils.eqEmptyValue)(o)&&(o=(0,_util.getRowUniqueId)(),_xeUtils.default.set(e,f,o)),v&&e[c.hasChild]&&_xeUtils.default.isUndefined(e[c.children])&&(e[c.children]=null);var i={row:e,rowid:o,index:u&&l?-1:t,_index:-1,$index:-1,items:r,parent:l};a&&(s[o]=i),d[o]=i};a&&(s=B.fullDataRowIdData={}),d=B.fullAllDataRowIdData={},u?_xeUtils.default.eachTree(e,t,c):e.forEach(t)},analyColumnWidth:function(){var e=B.tableFullColumn,t=b.value,r=t.width,n=t.minWidth,l=[],o=[],i=[],a=[],u=[],c=[];e.forEach(function(e){r&&!e.width&&(e.width=r),n&&!e.minWidth&&(e.minWidth=n),e.visible&&(e.resizeWidth?l.push(e):(0,_dom.isPx)(e.width)?o.push(e):(0,_dom.isScale)(e.width)?a.push(e):(0,_dom.isPx)(e.minWidth)?i.push(e):(0,_dom.isScale)(e.minWidth)?u.push(e):c.push(e))}),Object.assign(Y.columnStore,{resizeList:l,pxList:o,pxMinList:i,scaleList:a,scaleMinList:u,autoList:c})},saveCustomResizable:function(e){var t=P.id,r=P.customConfig,n=U.value,l=B.collectColumn,o=n.storage,i=!0===o||o&&o.resizable;if(r&&i){var a,u=be(resizableStorageKey);if(!t)return void(0,_utils.errLog)("vxe.error.reqProp",["id"]);e||(a=_xeUtils.default.isPlainObject(u[t])?u[t]:{},_xeUtils.default.eachTree(l,function(e){if(e.resizeWidth){var t=e.getKey();t&&(a[t]=e.renderWidth)}})),u[t]=_xeUtils.default.isEmpty(a)?void 0:a,localStorage.setItem(resizableStorageKey,_xeUtils.default.toJSONString(u))}},saveCustomVisible:function(){var e=P.id,t=P.customConfig,r=B.collectColumn,n=U.value,l=n.checkMethod,o=n.storage,i=!0===o||o&&o.visible;if(t&&i){var a=be(visibleStorageKey),u=[],c=[];if(!e)return void(0,_utils.errLog)("vxe.error.reqProp",["id"]);_xeUtils.default.eachTree(r,function(e){if(!l||l({column:e}))if(!e.visible&&e.defaultVisible)(t=e.getKey())&&u.push(t);else if(e.visible&&!e.defaultVisible){var t;(t=e.getKey())&&c.push(t)}}),a[e]=[u.join(",")].concat(c.length?[c.join(",")]:[]).join("|")||void 0,localStorage.setItem(visibleStorageKey,_xeUtils.default.toJSONString(a))}},handleCustom:function(){return Z.saveCustomVisible(),Z.analyColumnWidth(),G.refreshColumn()},preventEvent:function(t,e,r,n,l){var o;return _vXETable.VXETable.interceptor.get(e).some(function(e){return!1===e(Object.assign({$grid:x,$table:pe,$event:t},r))})||n&&(o=n()),l&&l(),o},checkSelectionStatus:function(){var e=P.treeConfig,t=Y.selection,r=Y.treeIndeterminates,n=B.afterFullData,l=R.value,o=l.checkField,i=l.halfField,a=l.checkStrictly,u=l.checkMethod;if(!a){var c=!1,s=!1;s=o?(c=0<n.length&&n.every(u?function(e){return!u({row:e})||_xeUtils.default.get(e,o)}:function(e){return _xeUtils.default.get(e,o)}),e?i?!c&&n.some(function(e){return _xeUtils.default.get(e,o)||_xeUtils.default.get(e,i)||-1<pe.findRowIndexOf(r,e)}):!c&&n.some(function(e){return _xeUtils.default.get(e,o)||-1<pe.findRowIndexOf(r,e)}):i?!c&&n.some(function(e){return _xeUtils.default.get(e,o)||_xeUtils.default.get(e,i)}):!c&&n.some(function(e){return _xeUtils.default.get(e,o)})):(c=0<n.length&&n.every(u?function(e){return!u({row:e})||-1<pe.findRowIndexOf(t,e)}:function(e){return-1<pe.findRowIndexOf(t,e)}),e?!c&&n.some(function(e){return-1<pe.findRowIndexOf(r,e)||-1<pe.findRowIndexOf(t,e)}):!c&&n.some(function(e){return-1<pe.findRowIndexOf(t,e)})),Y.isAllSelected=c,Y.isIndeterminate=s}},handleSelectRow:function(e,r){var t,n=e.row,l=P.treeConfig,o=Y.selection,i=Y.treeIndeterminates,a=B.afterFullData,u=ve.value,c=R.value,s=c.checkField,d=c.checkStrictly,f=c.checkMethod;if(s)if(l&&!d){if(-1===r?(-1===pe.findRowIndexOf(i,n)&&i.push(n),_xeUtils.default.set(n,s,!1)):_xeUtils.default.eachTree([n],function(t){(pe.eqRow(t,n)||!f||f({row:t}))&&(_xeUtils.default.set(t,s,r),_xeUtils.default.remove(i,function(e){return e===t}),Ne(n,r))},u),(t=_xeUtils.default.findTree(a,function(e){return e===n},u))&&t.parent){var v=void 0,g=f?t.items.filter(function(e){return f({row:e})}):t.items;if(_xeUtils.default.find(t.items,function(e){return-1<pe.findRowIndexOf(i,e)}))v=-1;else v=(h=t.items.filter(function(e){return _xeUtils.default.get(e,s)})).filter(function(e){return-1<pe.findRowIndexOf(g,e)}).length===g.length||!(!h.length&&-1!==r)&&-1;return Z.handleSelectRow({row:t.parent},v)}}else f&&!f({row:n})||(_xeUtils.default.set(n,s,r),Ne(n,r));else if(l&&!d){if(-1===r?(-1===pe.findRowIndexOf(i,n)&&i.push(n),_xeUtils.default.remove(o,function(e){return e===n})):_xeUtils.default.eachTree([n],function(t){(pe.eqRow(t,n)||!f||f({row:t}))&&(r?o.push(t):_xeUtils.default.remove(o,function(e){return e===t}),_xeUtils.default.remove(i,function(e){return e===t}),Ne(n,r))},u),(t=_xeUtils.default.findTree(a,function(e){return e===n},u))&&t.parent){v=void 0;var h,x=f?t.items.filter(function(e){return f({row:e})}):t.items;if(_xeUtils.default.find(t.items,function(e){return-1<pe.findRowIndexOf(i,e)}))v=-1;else v=(h=t.items.filter(function(e){return-1<pe.findRowIndexOf(o,e)})).filter(function(e){return-1<pe.findRowIndexOf(x,e)}).length===x.length||!(!h.length&&-1!==r)&&-1;return Z.handleSelectRow({row:t.parent},v)}}else f&&!f({row:n})||(r?-1===pe.findRowIndexOf(o,n)&&o.push(n):_xeUtils.default.remove(o,function(e){return e===n}),Ne(n,r));Z.checkSelectionStatus()},triggerHeaderHelpEvent:function(e,t){var r=t.column.titleHelp;if(r.message){var n=B.tooltipStore,l=H.value,o=(0,_utils.getFuncText)(r.message);at(),n.visible=!0,l&&l.open(e.currentTarget,o)}},triggerHeaderTooltipEvent:function(e,t){var r=B.tooltipStore,n=t.column,l=e.currentTarget;at(),r.column===n&&r.visible||ut(0,l,l,null,t)},triggerBodyTooltipEvent:function(e,t){var r=P.editConfig,n=Y.editStore,l=B.tooltipStore,o=ae.value,i=n.actived,a=t.row,u=t.column,c=e.currentTarget;if(at(),!((0,_utils.isEnableConf)(r)&&("row"===o.mode&&i.row===a||i.row===a&&i.column===u)||l.column===u&&l.row===a&&l.visible)){var s=void 0,d=void 0;u.treeNode?(s=c.querySelector(".vxe-tree-cell"),"html"===u.type&&(d=c.querySelector(".vxe-cell--html"))):d=c.querySelector("html"===u.type?".vxe-cell--html":".vxe-cell--label"),ut(0,c,s||c.children[0],d,t)}},triggerFooterTooltipEvent:function(e,t){var r=t.column,n=B.tooltipStore,l=e.currentTarget;at(),n.column===r&&n.visible||ut(0,l,l.querySelector(".vxe-cell--item")||l.children[0],null,t)},handleTargetLeaveEvent:function(){var e=le.value;B.tooltipActive=!1,e.enterable?B.tooltipTimeout=setTimeout(function(){var e=H.value;e&&!e.reactData.isHover&&G.closeTooltip()},e.leaveDelay):G.closeTooltip()},triggerHeaderCellClickEvent:function(e,t){var r=B._lastResizeTime,n=C.value,l=t.column,o=e.currentTarget,i=r&&r>Date.now()-300,a=(0,_dom.getEventTargetNode)(e,o,"vxe-cell--sort").flag,u=(0,_dom.getEventTargetNode)(e,o,"vxe-cell--filter").flag;"cell"!==n.trigger||i||a||u||Z.triggerSortEvent(e,l,we(l)),G.dispatchEvent("header-cell-click",Object.assign({triggerResizable:i,triggerSort:a,triggerFilter:u,cell:o},t),e),P.highlightCurrentColumn&&G.setCurrentColumn(l)},triggerHeaderCellDblclickEvent:function(e,t){G.dispatchEvent("header-cell-dblclick",Object.assign({cell:e.currentTarget},t),e)},triggerCellClickEvent:function(e,t){var r=P.highlightCurrentRow,n=P.editConfig,l=Y.editStore,o=L.value,i=ae.value,a=ve.value,u=E.value,c=R.value,s=l.actived,d=t.row,f=t.column,v=f.type,g=f.treeNode,h="radio"===v,x="checkbox"===v,m="expand"===v,p=e.currentTarget,_=h&&(0,_dom.getEventTargetNode)(e,p,"vxe-cell--radio").flag,w=x&&(0,_dom.getEventTargetNode)(e,p,"vxe-cell--checkbox").flag,b=g&&(0,_dom.getEventTargetNode)(e,p,"vxe-tree--btn-wrapper").flag,C=m&&(0,_dom.getEventTargetNode)(e,p,"vxe-table--expanded").flag;t=Object.assign({cell:p,triggerRadio:_,triggerCheckbox:w,triggerTreeNode:b,triggerExpandNode:C},t),w||_||(!C&&("row"===o.trigger||m&&"cell"===o.trigger)&&Z.triggerRowExpandEvent(e,t),("row"===a.trigger||g&&"cell"===a.trigger)&&Z.triggerTreeExpandEvent(e,t)),b||(C||(r&&(w||_||Z.triggerCurrentRowEvent(e,t)),!_&&("row"===u.trigger||h&&"cell"===u.trigger)&&Z.triggerRadioRowEvent(e,t),!w&&("row"===c.trigger||x&&"cell"===c.trigger)&&Z.handleToggleCheckRowEvent(e,t)),(0,_utils.isEnableConf)(n)&&("manual"===i.trigger?s.args&&s.row===d&&f!==s.column&&Fe(e,t):s.args&&d===s.row&&f===s.column||("click"===i.trigger?Fe(e,t):"dblclick"===i.trigger&&"row"===i.mode&&s.row===d&&Fe(e,t)))),G.dispatchEvent("cell-click",t,e)},triggerCellDblclickEvent:function(e,t){var r=P.editConfig,n=Y.editStore,l=ae.value,o=n.actived,i=e.currentTarget;t=Object.assign({cell:i},t),(0,_utils.isEnableConf)(r)&&"dblclick"===l.trigger&&(o.args&&e.currentTarget===o.args.cell||("row"===l.mode?Ae("blur").catch(function(e){return e}).then(function(){pe.handleActived(t,e).then(function(){return Ae("change")}).catch(function(e){return e})}):"cell"===l.mode&&pe.handleActived(t,e).then(function(){return Ae("change")}).catch(function(e){return e}))),G.dispatchEvent("cell-dblclick",t,e)},handleToggleCheckRowEvent:function(e,t){var r=Y.selection,n=R.value.checkField,l=t.row,o=n?!_xeUtils.default.get(l,n):-1===pe.findRowIndexOf(r,l);e?Z.triggerCheckRowEvent(e,t,o):Z.handleSelectRow(t,o)},triggerCheckRowEvent:function(e,t,r){var n=R.value.checkMethod;n&&!n({row:t.row})||(Z.handleSelectRow(t,r),G.dispatchEvent("checkbox-change",Object.assign({records:G.getCheckboxRecords(),reserves:G.getCheckboxReserveRecords(),indeterminates:G.getCheckboxIndeterminateRecords(),checked:r},t),e))},triggerCheckAllEvent:function(e,t){G.setAllCheckboxRow(t),e&&G.dispatchEvent("checkbox-all",{records:G.getCheckboxRecords(),reserves:G.getCheckboxReserveRecords(),indeterminates:G.getCheckboxIndeterminateRecords(),checked:t},e)},triggerRadioRowEvent:function(e,t){var r=Y.selectRow,n=t.row,l=E.value,o=n,i=r!==o;i?G.setRadioRow(o):l.strict||(i=r===o)&&(o=null,G.clearRadioRow()),i&&G.dispatchEvent("radio-change",__assign({oldValue:r,newValue:o},t),e)},triggerCurrentRowEvent:function(e,t){var r=Y.currentRow,n=t.row,l=r!==n;G.setCurrentRow(n),l&&G.dispatchEvent("current-change",__assign({oldValue:r,newValue:n},t),e)},triggerRowExpandEvent:function(e,t){var r=Y.expandLazyLoadeds,n=Y.expandColumn,l=L.value,o=t.row;if(!l.lazy||-1===pe.findRowIndexOf(r,o)){var i=!G.isExpandByRow(o),a=G.getColumnIndex(n),u=G.getVMColumnIndex(n);G.setRowExpand(o,i),G.dispatchEvent("toggle-row-expand",{expanded:i,column:n,columnIndex:a,$columnIndex:u,row:o,rowIndex:G.getRowIndex(o),$rowIndex:G.getVMRowIndex(o)},e)}},triggerTreeExpandEvent:function(e,t){var r=Y.treeLazyLoadeds,n=ve.value,l=t.row,o=t.column;if(!n.lazy||-1===pe.findRowIndexOf(r,l)){var i=!G.isTreeExpandByRow(l),a=G.getColumnIndex(o),u=G.getVMColumnIndex(o);G.setTreeExpand(l,i),G.dispatchEvent("toggle-tree-expand",{expanded:i,column:o,columnIndex:a,$columnIndex:u,row:l},e)}},triggerSortEvent:function(e,t,r){var n=C.value,l=t.property;if(t.sortable){r&&t.order!==r?G.sort({field:l,order:r}):G.clearSort(n.multiple?t:null);var o={column:t,property:l,order:t.order,sortList:G.getSortColumns()};G.dispatchEvent("sort-change",o,e)}},triggerScrollXEvent:function(){Pe()},triggerScrollYEvent:function(e){var t=B.scrollYStore,r=t.adaptive,n=t.offsetSize,l=t.visibleSize;isWebkit&&r&&2*n+l<=40?Ge(e):Ze(e)},scrollToTreeRow:function(t){var e=P.treeConfig,r=B.tableFullData,n=[];if(e){var l=ve.value,o=_xeUtils.default.findTree(r,function(e){return e===t},l);if(o){var i=o.nodes;i.forEach(function(e,t){t<i.length-1&&!G.isTreeExpandByRow(e)&&n.push(G.setTreeExpand(e,!0))})}}return Promise.all(n).then(function(){return(0,_util.rowToVisible)(pe,t)})},updateScrollXSpace:function(){var n=Y.scrollXLoad,l=Y.scrollbarWidth,e=B.visibleColumn,t=B.scrollXStore,o=B.elemStore,i=B.tableWidth,r=W.value,a=K.value,u=J.value,c=a?a.$el:null;if(c){var s=r?r.$el:null,d=u?u.$el:null,f=s?s.querySelector(".vxe-table--header"):null,v=c.querySelector(".vxe-table--body"),g=d?d.querySelector(".vxe-table--footer"):null,h=e.slice(0,t.startIndex).reduce(function(e,t){return e+t.renderWidth},0),x="";n&&(x=h+"px"),f&&(f.style.marginLeft=x),v.style.marginLeft=x,g&&(g.style.marginLeft=x);["main"].forEach(function(r){["header","body","footer"].forEach(function(e){var t=o[r+"-"+e+"-xSpace"];t&&(t.style.width=n?i+("header"===e?l:0)+"px":"")})}),(0,_vue.nextTick)(Me)}},updateScrollYSpace:function(){var e=Y.scrollYLoad,t=B.scrollYStore,n=B.elemStore,r=B.afterFullData,l=t.startIndex,o=t.rowHeight,i=r.length*o,a=Math.max(0,l*o),u="",c="";e&&(u=a+"px",c=i+"px"),["main","left","right"].forEach(function(r){var e=n[r+"-body-table"];e&&(e.style.marginTop=u),["header","body","footer"].forEach(function(e){var t=n[r+"-"+e+"-ySpace"];t&&(t.style.height=c)})}),(0,_vue.nextTick)(Me)},updateScrollXData:function(){Ke(),Z.updateScrollXSpace()},updateScrollYData:function(){Z.handleTableData(),Z.updateScrollYSpace()},checkScrolling:function(){var e=Q.value,t=ee.value,r=K.value,n=r?r.$el:null;n&&(e&&(0<n.scrollLeft?(0,_dom.addClass)(e,"scrolling--middle"):(0,_dom.removeClass)(e,"scrolling--middle")),t&&(n.clientWidth<n.scrollWidth-Math.ceil(n.scrollLeft)?(0,_dom.addClass)(t,"scrolling--middle"):(0,_dom.removeClass)(t,"scrolling--middle")))},updateZindex:function(){P.zIndex?B.tZindex=P.zIndex:B.tZindex<(0,_utils.getLastZIndex)()&&(B.tZindex=(0,_utils.nextZIndex)())},updateCellAreas:function(){var e=P.mouseConfig,t=ue.value;e&&t.area&&pe.handleUpdateCellAreas&&pe.handleUpdateCellAreas()},triggerHoverEvent:function(e,t){var r=t.row;Z.setHoverRow(r)},setHoverRow:function(e){var t=(0,_util.getRowid)(pe,e),r=z.value;Z.clearHoverRow(),r&&_xeUtils.default.arrayEach(r.querySelectorAll('[rowid="'+t+'"]'),function(e){return(0,_dom.addClass)(e,"row--hover")}),B.hoverRow=e},clearHoverRow:function(){var e=z.value;e&&_xeUtils.default.arrayEach(e.querySelectorAll(".vxe-body--row.row--hover"),function(e){return(0,_dom.removeClass)(e,"row--hover")}),B.hoverRow=null},getCell:function(e,t){var r,n=(0,_util.getRowid)(pe,e),l=K.value,o=d.value,i=g.value;return t.fixed&&("left"===t.fixed?o&&(r=o.$el):i&&(r=i.$el)),r||(r=l.$el),r?r.querySelector('.vxe-body--row[rowid="'+n+'"] .'+t.id):null},getCellLabel:function(e,t){var r=t.formatter,n=(0,_util.getCellValue)(e,t),l=n;if(r){var o=void 0,i=B.fullAllDataRowIdData,a=(0,_util.getRowid)(pe,e),u=t.id,c=i[a];if(c&&((o=c.formatData)||(o=i[a].formatData={}),c&&o[u]&&o[u].value===n))return o[u].label;var s={cellValue:n,row:e,rowIndex:G.getRowIndex(e),column:t,columnIndex:G.getColumnIndex(t)};if(_xeUtils.default.isString(r))l=(d=_vXETable.VXETable.formats.get(r))?d(s):"";else if(_xeUtils.default.isArray(r)){var d;l=(d=_vXETable.VXETable.formats.get(r[0]))?d.apply(void 0,__spreadArray([s],r.slice(1))):""}else l=r(s);o&&(o[u]={value:n,label:l})}return l},findRowIndexOf:function(e,t){return t?_xeUtils.default.findIndexOf(e,function(e){return pe.eqRow(e,t)}):-1},eqRow:function(e,t){return!(!e||!t)&&(e===t||(0,_util.getRowid)(pe,e)===(0,_util.getRowid)(pe,t))}},Object.assign(pe,G,Z);var ct,st=function(e){var t=P.showHeader,r=P.showFooter,n=Y.tableData,l=Y.tableColumn,o=Y.tableGroupColumn,i=Y.columnStore,a=Y.footerTableData,u="left"===e,c=u?i.leftList:i.rightList;return(0,_vue.h)("div",{ref:u?Q:ee,class:"vxe-table--fixed-"+e+"-wrapper"},[t?(0,_vue.h)((0,_vue.resolveComponent)("vxe-table-header"),{ref:u?s:v,fixedType:e,tableData:n,tableColumn:l,tableGroupColumn:o,fixedColumn:c}):(0,_vue.createCommentVNode)(),(0,_vue.h)(_body.default,{ref:u?d:g,fixedType:e,tableData:n,tableColumn:l,fixedColumn:c}),r?(0,_vue.h)((0,_vue.resolveComponent)("vxe-table-footer"),{ref:u?f:h,footerTableData:a,tableColumn:l,fixedColumn:c,fixedType:e}):(0,_vue.createCommentVNode)()])};function dt(){var e=z.value;e&&e.clientWidth&&e.clientHeight&&G.recalculate()}(0,_vue.watch)(function(){return P.data},function(e){var n=B.inited,l=B.initStatus;Xe(e||[]).then(function(){var e=Y.scrollXLoad,t=Y.scrollYLoad,r=Y.expandColumn;B.inited=!0,B.initStatus=!0,l||je(),n||We(),"development"===process.env.NODE_ENV&&(e||t)&&r&&(0,_utils.warnLog)("vxe.error.scrollErrProp",["column.type=expand"]),G.recalculate()})}),(0,_vue.watch)(function(){return Y.staticColumns},function(e){Be(e)}),(0,_vue.watch)(function(){return Y.tableColumn},function(){Z.analyColumnWidth()}),(0,_vue.watch)(function(){return P.showHeader},function(){(0,_vue.nextTick)(function(){G.recalculate(!0).then(function(){return G.refreshScroll()})})}),(0,_vue.watch)(function(){return P.showFooter},function(){(0,_vue.nextTick)(function(){G.recalculate(!0).then(function(){return G.refreshScroll()})})}),(0,_vue.watch)(function(){return P.height},function(){(0,_vue.nextTick)(function(){return G.recalculate(!0)})}),(0,_vue.watch)(function(){return P.maxHeight},function(){(0,_vue.nextTick)(function(){return G.recalculate(!0)})}),(0,_vue.watch)(function(){return P.syncResize},function(e){e&&(dt(),(0,_vue.nextTick)(function(){dt(),setTimeout(function(){return dt()})}))}),(0,_vue.watch)(function(){return P.mergeCells},function(e){G.clearMergeCells(),(0,_vue.nextTick)(function(){e&&G.setMergeCells(e)})}),(0,_vue.watch)(function(){return P.mergeFooterItems},function(e){G.clearMergeFooterItems(),(0,_vue.nextTick)(function(){e&&G.setMergeFooterItems(e)})}),_vXETable.VXETable.hooks.forEach(function(e){var t=e.setupTable;if(t){var r=t(pe);r&&_xeUtils.default.isObject(r)&&Object.assign(pe,r)}}),Z.preventEvent(null,"created",{$table:pe}),(0,_vue.onActivated)(function(){G.recalculate().then(function(){return G.refreshScroll()}),Z.preventEvent(null,"activated",{$table:pe})}),(0,_vue.onDeactivated)(function(){B.isActivated=!1,Z.preventEvent(null,"deactivated",{$table:pe})}),(0,_vue.onMounted)(function(){(0,_vue.nextTick)(function(){var e=P.data,t=P.treeConfig,r=P.showOverflow,n=B.scrollXStore,l=B.scrollYStore,o=w.value,i=ae.value,a=ve.value,u=E.value,c=R.value,s=L.value;if("development"===process.env.NODE_ENV){!P.rowId&&(c.reserve||c.checkRowKeys||u.reserve||u.checkRowKey||s.expandRowKeys||a.expandRowKeys)&&(0,_utils.warnLog)("vxe.error.reqProp",["row-id"]),P.editConfig&&(i.showStatus||i.showUpdateStatus||i.showInsertStatus)&&!P.keepSource&&(0,_utils.warnLog)("vxe.error.reqProp",["keep-source"]),!t||!a.line||P.rowKey&&r||(0,_utils.warnLog)("vxe.error.reqProp",["row-key | show-overflow"]),t&&P.stripe&&(0,_utils.warnLog)("vxe.error.noTree",["stripe"]),P.showFooter&&!P.footerMethod&&(0,_utils.warnLog)("vxe.error.reqProp",["footer-method"]);var d=P.exportConfig,f=P.importConfig,v=I.value,g=D.value;f&&g.types&&!g.importMethod&&!_xeUtils.default.includeArrays(_vXETable.VXETable.config.importTypes,g.types)&&(0,_utils.warnLog)("vxe.error.errProp",["export-config.types="+g.types.join(","),g.types.filter(function(e){return _xeUtils.default.includes(_vXETable.VXETable.config.importTypes,e)}).join(",")||_vXETable.VXETable.config.importTypes.join(",")]),d&&v.types&&!v.exportMethod&&!_xeUtils.default.includeArrays(_vXETable.VXETable.config.exportTypes,v.types)&&(0,_utils.warnLog)("vxe.error.errProp",["export-config.types="+v.types.join(","),v.types.filter(function(e){return _xeUtils.default.includes(_vXETable.VXETable.config.exportTypes,e)}).join(",")||_vXETable.VXETable.config.exportTypes.join(",")])}if("development"===process.env.NODE_ENV){var h=U.value,x=ue.value;if(!P.id&&P.customConfig&&(!0===h.storage||h.storage&&h.storage.resizable||h.storage&&h.storage.visible)&&(0,_utils.errLog)("vxe.error.reqProp",["id"]),P.treeConfig&&c.range&&(0,_utils.errLog)("vxe.error.noTree",["checkbox-config.range"]),!pe.handleUpdateCellAreas&&(P.clipConfig&&(0,_utils.warnLog)("vxe.error.notProp",["clip-config"]),P.fnrConfig&&(0,_utils.warnLog)("vxe.error.notProp",["fnr-config"]),x.area))return void(0,_utils.errLog)("vxe.error.notProp",["mouse-config.area"]);x.area&&x.selected&&(0,_utils.warnLog)("vxe.error.errConflicts",["mouse-config.area","mouse-config.selected"]),x.area&&c.range&&(0,_utils.warnLog)("vxe.error.errConflicts",["mouse-config.area","checkbox-config.range"]),P.treeConfig&&x.area&&(0,_utils.errLog)("vxe.error.noTree",["mouse-config.area"])}if("development"===process.env.NODE_ENV&&(P.editConfig&&!pe.insert&&(0,_utils.errLog)("vxe.error.reqModule",["Edit"]),P.editRules&&!pe.validate&&(0,_utils.errLog)("vxe.error.reqModule",["Validator"]),(c.range||P.keyboardConfig||P.mouseConfig)&&!pe.triggerCellMousedownEvent&&(0,_utils.errLog)("vxe.error.reqModule",["Keyboard"]),(P.printConfig||P.importConfig||P.exportConfig)&&!pe.exportData&&(0,_utils.errLog)("vxe.error.reqModule",["Export"])),Object.assign(l,{startIndex:0,endIndex:0,visibleSize:0,adaptive:!1!==o.adaptive}),Object.assign(n,{startIndex:0,endIndex:0,visibleSize:0}),Xe(e||[]).then(function(){e&&e.length&&(B.inited=!0,B.initStatus=!0,je(),We()),Me()}),P.autoResize){var m=z.value,p=Z.getParentElem();ct=(0,_resize.createResizeEvent)(function(){P.autoResize&&G.recalculate(!0)}),m&&ct.observe(m),p&&ct.observe(p)}}),_event.GlobalEvent.on(pe,"paste",nt),_event.GlobalEvent.on(pe,"copy",lt),_event.GlobalEvent.on(pe,"cut",ot),_event.GlobalEvent.on(pe,"mousedown",Je),_event.GlobalEvent.on(pe,"blur",Qe),_event.GlobalEvent.on(pe,"mousewheel",et),_event.GlobalEvent.on(pe,"keydown",rt),_event.GlobalEvent.on(pe,"resize",it),pe.handleGlobalContextmenuEvent&&_event.GlobalEvent.on(pe,"contextmenu",pe.handleGlobalContextmenuEvent),Z.preventEvent(null,"mounted",{$table:pe})}),(0,_vue.onBeforeUnmount)(function(){ct&&ct.disconnect(),G.closeFilter(),pe.closeMenu&&pe.closeMenu(),Z.preventEvent(null,"beforeUnmount",{$table:pe})}),(0,_vue.onUnmounted)(function(){_event.GlobalEvent.off(pe,"paste"),_event.GlobalEvent.off(pe,"copy"),_event.GlobalEvent.off(pe,"cut"),_event.GlobalEvent.off(pe,"mousedown"),_event.GlobalEvent.off(pe,"blur"),_event.GlobalEvent.off(pe,"mousewheel"),_event.GlobalEvent.off(pe,"keydown"),_event.GlobalEvent.off(pe,"resize"),_event.GlobalEvent.off(pe,"contextmenu"),Z.preventEvent(null,"unmounted",{$table:pe})});return pe.renderVN=function(){var e,t=P.loading,r=P.stripe,n=P.showHeader,l=P.height,o=P.treeConfig,i=P.mouseConfig,a=P.showFooter,u=P.highlightCell,c=P.highlightHoverRow,s=P.highlightHoverColumn,d=P.editConfig,f=Y.isGroup,v=Y.overflowX,g=Y.overflowY,h=Y.scrollXLoad,x=Y.scrollYLoad,m=Y.scrollbarHeight,p=Y.tableData,_=Y.tableColumn,w=Y.tableGroupColumn,b=Y.footerTableData,C=Y.initStore,E=Y.columnStore,R=Y.filterStore,T=E.leftList,y=E.rightList,S=le.value,I=ve.value,D=V.value,k=xe.value,L=ue.value,U=ne.value,O=ie.value,M=de.value;return(0,_vue.h)("div",{ref:z,class:["vxe-table","vxe-table--render-default","tid_"+N,"border--"+k,(e={},e["size--"+D]=D,e["vxe-editable"]=!!d,e["cell--highlight"]=u,e["cell--selected"]=i&&L.selected,e["cell--area"]=i&&L.area,e["row--highlight"]=c,e["column--highlight"]=s,e["is--header"]=n,e["is--footer"]=a,e["is--group"]=f,e["is--tree-line"]=o&&I.line,e["is--fixed-left"]=T.length,e["is--fixed-right"]=y.length,e["is--animat"]=!!P.animat,e["is--round"]=P.round,e["is--stripe"]=!o&&r,e["is--loading"]=t,e["is--empty"]=!t&&!p.length,e["is--scroll-y"]=g,e["is--scroll-x"]=v,e["is--virtual-x"]=h,e["is--virtual-y"]=x,e)],onKeydown:tt},[(0,_vue.h)("div",{class:"vxe-table-slots"},A.default?A.default({}):[]),(0,_vue.h)("div",{class:"vxe-table--render-wrapper"},[(0,_vue.h)("div",{class:"vxe-table--main-wrapper"},[n?(0,_vue.h)((0,_vue.resolveComponent)("vxe-table-header"),{ref:W,tableData:p,tableColumn:_,tableGroupColumn:w}):(0,_vue.createCommentVNode)(),(0,_vue.h)(_body.default,{ref:K,tableData:p,tableColumn:_}),a?(0,_vue.h)((0,_vue.resolveComponent)("vxe-table-footer"),{ref:J,footerTableData:b,tableColumn:_}):(0,_vue.createCommentVNode)()]),(0,_vue.h)("div",{class:"vxe-table--fixed-wrapper"},[T&&T.length&&v?st("left"):(0,_vue.createCommentVNode)(),y&&y.length&&v?st("right"):(0,_vue.createCommentVNode)()])]),(0,_vue.h)("div",{ref:re,class:"vxe-table--empty-placeholder"},[(0,_vue.h)("div",{class:"vxe-table--empty-content"},function(){var e=ge.value,t={$table:pe};if(A.empty)return A.empty(t);var r=e.name?_vXETable.VXETable.renderer.get(e.name):null,n=r?r.renderEmpty:null;return n?n(e,t):(0,_utils.getFuncText)(P.emptyText)||_conf.default.i18n("vxe.table.emptyText")}())]),(0,_vue.h)("div",{class:"vxe-table--border-line"}),(0,_vue.h)("div",{ref:te,class:"vxe-table--resizable-bar",style:v?{"padding-bottom":m+"px"}:null}),(0,_vue.h)("div",{class:["vxe-table--loading vxe-loading",{"is--visible":t}]},[(0,_vue.h)("div",{class:"vxe-loading--spinner"})]),C.filter?(0,_vue.h)((0,_vue.resolveComponent)("vxe-table-filter"),{ref:X,filterStore:R}):(0,_vue.createCommentVNode)(),C.import&&P.importConfig?(0,_vue.h)((0,_vue.resolveComponent)("vxe-import-panel"),{defaultOptions:Y.importParams,storeData:Y.importStore}):(0,_vue.createCommentVNode)(),C.export&&(P.exportConfig||P.printConfig)?(0,_vue.h)((0,_vue.resolveComponent)("vxe-export-panel"),{defaultOptions:Y.exportParams,storeData:Y.exportStore}):(0,_vue.createCommentVNode)(),M?(0,_vue.h)((0,_vue.resolveComponent)("vxe-table-context-menu"),{ref:j}):(0,_vue.createCommentVNode)(),F?(0,_vue.h)((0,_vue.resolveComponent)("vxe-tooltip"),{ref:q,isArrow:!1,enterable:!1}):(0,_vue.createCommentVNode)(),F&&P.editRules&&U.showMessage&&("default"===U.message?!l:"tooltip"===U.message)?(0,_vue.h)((0,_vue.resolveComponent)("vxe-tooltip"),__assign({ref:$,class:"vxe-table--valid-error"},"tooltip"===U.message||1===p.length?O:{})):(0,_vue.createCommentVNode)(),F?(0,_vue.h)((0,_vue.resolveComponent)("vxe-tooltip"),__assign({ref:H},S)):(0,_vue.createCommentVNode)()])},(0,_vue.provide)("xecolgroup",null),(0,_vue.provide)("$xetable",pe),pe},render:function(){return this.renderVN()}});exports.default=_default;