"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _vue=require("vue"),_xeUtils=_interopRequireDefault(require("xe-utils")),_conf=_interopRequireDefault(require("../../v-x-e-table/src/conf")),_modal=_interopRequireDefault(require("../../modal/src/modal")),_group=_interopRequireDefault(require("../../radio/src/group")),_radio=_interopRequireDefault(require("../../radio/src/radio")),_button=_interopRequireDefault(require("../../button/src/button")),_utils=require("../../tools/utils");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var _default2=(0,_vue.defineComponent)({name:"VxeImportPanel",props:{defaultOptions:Object,storeData:Object},setup:function(o){var i=(0,_vue.inject)("$xetable",{}),n=i.getComputeMaps().computeImportOpts,a=(0,_vue.reactive)({loading:!1}),r=(0,_vue.ref)(),l=(0,_vue.computed)(function(){var e=o.storeData;return e.filename+"."+e.type}),f=(0,_vue.computed)(function(){var e=o.storeData;return e.file&&e.type}),c=(0,_vue.computed)(function(){var e=o.storeData,t=e.type,u=e.typeList;if(t){var i=_xeUtils.default.find(u,function(e){return t===e.value});return i?_conf.default.i18n(i.label):"*.*"}return"*."+u.map(function(e){return e.value}).join(", *.")}),d=function(){var e=o.storeData;Object.assign(e,{filename:"",sheetName:"",type:""})},s=function(){var u=o.storeData,e=o.defaultOptions;i.readFile(e).then(function(e){var t=e.file;Object.assign(u,(0,_utils.parseFile)(t),{file:t})}).catch(function(e){return e})},v=function(){(0,_vue.nextTick)(function(){var e=r.value;e&&e.focus()})},_=function(){o.storeData.visible=!1},p=function(){var e=o.storeData,t=o.defaultOptions,u=n.value;a.loading=!0,i.importByFile(e.file,Object.assign({},u,t)).then(function(){a.loading=!1,e.visible=!1}).catch(function(){a.loading=!1})};return function(){var t=o.defaultOptions,u=o.storeData,e=l.value,i=f.value,n=c.value;return(0,_vue.h)(_modal.default,{modelValue:u.visible,title:_conf.default.i18n("vxe.import.impTitle"),width:440,mask:!0,lockView:!0,showFooter:!1,escClosable:!0,maskClosable:!0,loading:a.loading,"onUpdate:modelValue":function(e){u.visible=e},onShow:v},{default:function(){return(0,_vue.h)("div",{class:"vxe-export--panel"},[(0,_vue.h)("table",{cellspacing:0,cellpadding:0,border:0},[(0,_vue.h)("tbody",[(0,_vue.h)("tr",[(0,_vue.h)("td",_conf.default.i18n("vxe.import.impFile")),(0,_vue.h)("td",[i?(0,_vue.h)("div",{class:"vxe-import-selected--file",title:e},[(0,_vue.h)("span",e),(0,_vue.h)("i",{class:_conf.default.icon.INPUT_CLEAR,onClick:d})]):(0,_vue.h)("button",{ref:r,class:"vxe-import-select--file",onClick:s},_conf.default.i18n("vxe.import.impSelect"))])]),(0,_vue.h)("tr",[(0,_vue.h)("td",_conf.default.i18n("vxe.import.impType")),(0,_vue.h)("td",n)]),(0,_vue.h)("tr",[(0,_vue.h)("td",_conf.default.i18n("vxe.import.impOpts")),(0,_vue.h)("td",[(0,_vue.h)(_group.default,{modelValue:t.mode,"onUpdate:modelValue":function(e){t.mode=e}},{default:function(){return u.modeList.map(function(e){return(0,_vue.h)(_radio.default,{label:e.value,content:_conf.default.i18n(e.label)})})}})])])])]),(0,_vue.h)("div",{class:"vxe-export--panel-btns"},[(0,_vue.h)(_button.default,{content:_conf.default.i18n("vxe.import.impCancel"),onClick:_}),(0,_vue.h)(_button.default,{status:"primary",disabled:!i,content:_conf.default.i18n("vxe.import.impConfirm"),onClick:p})])])}})}}});exports.default=_default2;