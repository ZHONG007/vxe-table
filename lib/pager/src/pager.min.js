"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _vue=require("vue"),_xeUtils=_interopRequireDefault(require("xe-utils")),_conf=_interopRequireDefault(require("../../v-x-e-table/src/conf")),_event=require("../../tools/event"),_size=require("../../hooks/size");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var __assign=function(){return(__assign=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var u in t=arguments[n])Object.prototype.hasOwnProperty.call(t,u)&&(e[u]=t[u]);return e}).apply(this,arguments)},_default2=(0,_vue.defineComponent)({name:"VxePager",props:{size:{type:String,default:function(){return _conf.default.pager.size||_conf.default.size}},layouts:{type:Array,default:function(){return _conf.default.pager.layouts||["PrevJump","PrevPage","Jump","PageCount","NextPage","NextJump","Sizes","Total"]}},currentPage:{type:Number,default:1},loading:Boolean,pageSize:{type:Number,default:function(){return _conf.default.pager.pageSize||10}},total:{type:Number,default:0},pagerCount:{type:Number,default:function(){return _conf.default.pager.pagerCount||7}},pageSizes:{type:Array,default:function(){return _conf.default.pager.pageSizes||[10,15,20,50,100]}},align:{type:String,default:function(){return _conf.default.pager.align}},border:{type:Boolean,default:function(){return _conf.default.pager.border}},background:{type:Boolean,default:function(){return _conf.default.pager.background}},perfect:{type:Boolean,default:function(){return _conf.default.pager.perfect}},autoHidden:{type:Boolean,default:function(){return _conf.default.pager.autoHidden}},transfer:{type:Boolean,default:function(){return _conf.default.pager.transfer}},className:[String,Function],iconPrevPage:String,iconJumpPrev:String,iconJumpNext:String,iconNextPage:String,iconJumpMore:String},emits:["update:pageSize","update:currentPage","page-change"],setup:function(s,e){var t,i=e.slots,a=e.emit,n=_xeUtils.default.uniqueId(),c=(0,_size.useSize)(s),p=(0,_vue.inject)("$xegrid",null),l=(0,_vue.ref)(),u={refElem:l},f={xID:n,props:s,context:e,getRefMaps:function(){return u}},r={},o=function(e,t){return Math.max(Math.ceil(e/t),1)},v=(0,_vue.computed)(function(){return o(s.total,s.pageSize)}),g=function(e,t){a("update:currentPage",t),e&&t!==s.currentPage&&r.dispatchEvent("page-change",{type:"current",pageSize:s.pageSize,currentPage:t},e)},_=function(e,t){a("update:currentPage",e),t&&e!==s.currentPage&&r.dispatchEvent("page-change",{type:"current",pageSize:s.pageSize,currentPage:e},t)},d=function(e){var t=e.target,n=_xeUtils.default.toNumber(t.value),a=v.value,u=n<=0?1:a<=n?a:n;t.value=_xeUtils.default.toValueString(u),_(u,e)},x=(0,_vue.computed)(function(){for(var e=s.pagerCount,t=e<v.value?e-2:e,n=[],a=0;a<t;a++)n.push(a);return n}),h=(0,_vue.computed)(function(){return Math.floor((s.pagerCount-2)/2)}),m=(0,_vue.computed)(function(){return s.pageSizes.map(function(e){return _xeUtils.default.isNumber(e)?{value:e,label:""+_conf.default.i18n("vxe.pager.pagesize",[e])}:__assign({value:"",label:""},e)})}),P=function(e){var t=s.currentPage,n=v.value;1<t&&_(Math.min(n,Math.max(t-1,1)),e)},b=function(e){var t=s.currentPage,n=v.value;t<n&&_(Math.min(n,t+1),e)},y=function(e){var t=x.value;_(Math.max(s.currentPage-t.length,1),e)},E=function(e){var t=v.value,n=x.value;_(Math.min(s.currentPage+n.length,t),e)},N=function(e){var t=e.value,n=_xeUtils.default.toNumber(t);a("update:pageSize",n),r.dispatchEvent("page-change",{type:"size",pageSize:n,currentPage:Math.min(s.currentPage,o(s.total,n))})},S=function(e){(0,_event.hasEventKey)(e,_event.EVENT_KEYS.ENTER)?d(e):(0,_event.hasEventKey)(e,_event.EVENT_KEYS.ARROW_UP)?(e.preventDefault(),b(e)):(0,_event.hasEventKey)(e,_event.EVENT_KEYS.ARROW_DOWN)&&(e.preventDefault(),P(e))},k=function(){return(0,_vue.h)("button",{class:["vxe-pager--prev-btn",{"is--disabled":s.currentPage<=1}],type:"button",title:_conf.default.i18n("vxe.pager.prevPage"),onClick:P},[(0,_vue.h)("i",{class:["vxe-pager--btn-icon",s.iconPrevPage||_conf.default.icon.PAGER_PREV_PAGE]})])},z=function(e){return(0,_vue.h)(e||"button",{class:["vxe-pager--jump-prev",{"is--fixed":!e,"is--disabled":s.currentPage<=1}],type:"button",title:_conf.default.i18n("vxe.pager.prevJump"),onClick:y},[e?(0,_vue.h)("i",{class:["vxe-pager--jump-more-icon",s.iconJumpMore||_conf.default.icon.PAGER_JUMP_MORE]}):null,(0,_vue.h)("i",{class:["vxe-pager--jump-icon",s.iconJumpPrev||_conf.default.icon.PAGER_JUMP_PREV]})])},J=function(e){var t=v.value;return(0,_vue.h)(e||"button",{class:["vxe-pager--jump-next",{"is--fixed":!e,"is--disabled":s.currentPage>=t}],type:"button",title:_conf.default.i18n("vxe.pager.nextJump"),onClick:E},[e?(0,_vue.h)("i",{class:["vxe-pager--jump-more-icon",s.iconJumpMore||_conf.default.icon.PAGER_JUMP_MORE]}):null,(0,_vue.h)("i",{class:["vxe-pager--jump-icon",s.iconJumpNext||_conf.default.icon.PAGER_JUMP_NEXT]})])},M=function(){var e=v.value;return(0,_vue.h)("button",{class:["vxe-pager--next-btn",{"is--disabled":s.currentPage>=e}],type:"button",title:_conf.default.i18n("vxe.pager.nextPage"),onClick:b},[(0,_vue.h)("i",{class:["vxe-pager--btn-icon",s.iconNextPage||_conf.default.icon.PAGER_NEXT_PAGE]})])},R=function(e){var a=s.currentPage,t=s.pagerCount,u=[],r=v.value,n=x.value,o=h.value,i=t<r,c=i&&o+1<a,p=i&&a<r-o,l=1;return i&&(l=r-o<=a?Math.max(r-n.length+1,1):Math.max(a-o,1)),e&&c&&u.push((0,_vue.h)("button",{class:"vxe-pager--num-btn",type:"button",onClick:function(e){return g(e,1)}},1),z("span")),n.forEach(function(e,t){var n=l+t;n<=r&&u.push((0,_vue.h)("button",{key:n,class:["vxe-pager--num-btn",{"is--active":a===n}],type:"button",onClick:function(e){return g(e,n)}},n))}),e&&p&&u.push(J("button"),(0,_vue.h)("button",{class:"vxe-pager--num-btn",type:"button",onClick:function(e){return g(e,r)}},r)),(0,_vue.h)("span",{class:"vxe-pager--btn-wrapper"},u)},C=function(){return R(!0)},j=function(){var e=m.value;return(0,_vue.h)((0,_vue.resolveComponent)("vxe-select"),{class:"vxe-pager--sizes",modelValue:s.pageSize,placement:"top",transfer:s.transfer,options:e,onChange:N})},A=function(e){return(0,_vue.h)("span",{class:"vxe-pager--jump"},[e?(0,_vue.h)("span",{class:"vxe-pager--goto-text"},_conf.default.i18n("vxe.pager.goto")):null,(0,_vue.h)("input",{class:"vxe-pager--goto",value:s.currentPage,type:"text",autocomplete:"off",onKeydown:S,onBlur:d}),e?(0,_vue.h)("span",{class:"vxe-pager--classifier-text"},_conf.default.i18n("vxe.pager.pageClassifier")):null])},T=function(){return A(!0)},U=function(){var e=v.value;return(0,_vue.h)("span",{class:"vxe-pager--count"},[(0,_vue.h)("span",{class:"vxe-pager--separator"}),(0,_vue.h)("span",e)])},O=function(){return(0,_vue.h)("span",{class:"vxe-pager--total"},_conf.default.i18n("vxe.pager.total",[s.total]))};r={dispatchEvent:function(e,t,n){a(e,Object.assign({$pager:f,$event:n},t))},prevPage:function(){return P(),(0,_vue.nextTick)()},nextPage:function(){return b(),(0,_vue.nextTick)()},prevJump:function(){return y(),(0,_vue.nextTick)()},nextJump:function(){return E(),(0,_vue.nextTick)()}},t={handlePrevPage:P,handleNextPage:b,handlePrevJump:y,handleNextJump:E},Object.assign(f,r,t);return f.renderVN=function(){var e,t=s.align,n=s.layouts,a=s.className,u=[],r=c.value,o=v.value;return i.left&&u.push((0,_vue.h)("span",{class:"vxe-pager--left-wrapper"},i.left({$grid:p}))),n.forEach(function(e){var t;switch(e){case"PrevPage":t=k;break;case"PrevJump":t=z;break;case"Number":t=R;break;case"JumpNumber":t=C;break;case"NextJump":t=J;break;case"NextPage":t=M;break;case"Sizes":t=j;break;case"FullJump":t=T;break;case"Jump":t=A;break;case"PageCount":t=U;break;case"Total":t=O}t&&u.push(t())}),i.right&&u.push((0,_vue.h)("span",{class:"vxe-pager--right-wrapper"},i.right({$grid:p}))),(0,_vue.h)("div",{ref:l,class:["vxe-pager",a?_xeUtils.default.isFunction(a)?a({$pager:f}):a:"",(e={},e["size--"+r]=r,e["align--"+t]=t,e["is--border"]=s.border,e["is--background"]=s.background,e["is--perfect"]=s.perfect,e["is--hidden"]=s.autoHidden&&1===o,e["is--loading"]=s.loading,e)]},[(0,_vue.h)("div",{class:"vxe-pager--wrapper"},u)])},f},render:function(){return this.renderVN()}});exports.default=_default2;