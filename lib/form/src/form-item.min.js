"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.formItemProps=exports.default=void 0;var _vue=require("vue"),_xeUtils=_interopRequireDefault(require("xe-utils")),_conf=_interopRequireDefault(require("../../v-x-e-table/src/conf")),_vXETable=require("../../v-x-e-table"),_utils=require("../../tools/utils"),_util=require("./util"),_render=require("./render");function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var __assign=function(){return(__assign=Object.assign||function(e){for(var t,i=1,l=arguments.length;i<l;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},formItemProps={title:String,field:String,span:[String,Number],align:String,titleAlign:String,titleWidth:[String,Number],className:[String,Function],titleOverflow:{type:[Boolean,String],default:null},titlePrefix:Object,titleSuffix:Object,resetValue:{default:null},visibleMethod:Function,visible:{type:Boolean,default:null},folding:Boolean,collapseNode:Boolean,itemRender:Object};exports.formItemProps=formItemProps;var _default=(0,_vue.defineComponent)({name:"VxeFormItem",props:formItemProps,setup:function(e,t){var i=t.slots,V=(0,_vue.ref)(),l=(0,_vue.inject)("$xeform",{}),r=(0,_vue.inject)("xeformgather",null),n=(0,_util.createItem)(l,e);n.slots=i,(0,_util.watchItem)(e,n),(0,_vue.onMounted)(function(){(0,_util.assemItem)(l,V.value,n,r)}),(0,_vue.onUnmounted)(function(){(0,_util.destroyItem)(l,n)});return function(){var e=l?l.props:null;return e&&e.customLayout?function(t,e){var i=t.props,l=t.reactData,r=i.data,n=i.rules,o=i.titleOverflow,u=l.collapseAll,s=t.getComputeMaps().computeValidOpts.value,a=e.slots,f=e.title,d=e.visible,v=e.folding,m=e.visibleMethod,c=e.field,_=e.collapseNode,p=e.itemRender,g=e.showError,x=e.errRule,h=e.className,b=e.titleOverflow,O=(0,_utils.isEnableConf)(p)?_vXETable.VXETable.renderer.get(p.name):null,I=a?a.default:null,M=a?a.title:null,q=e.span||i.span,N=e.align||i.align,y=e.titleAlign||i.titleAlign,S=e.titleWidth||i.titleWidth,w=_xeUtils.default.isUndefined(b)||_xeUtils.default.isNull(b)?o:b,F="title"===w,j=!0===w||"tooltip"===w,E=F||j||"ellipsis"===w,P=m,R={data:r,property:c,item:e,$form:t},U=!1;if(n){var C=n[c];C&&(U=C.some(function(e){return e.required}))}!P&&O&&O.itemVisibleMethod&&(P=O.itemVisibleMethod);var D=[];I?D=t.callSlot(I,R):O&&O.renderItemContent?D=O.renderItemContent(p,R):c&&(D=[""+_xeUtils.default.get(r,c)]),_&&D.push((0,_vue.h)("div",{class:"vxe-form--item-trigger-node",onClick:t.toggleCollapseEvent},[(0,_vue.h)("span",{class:"vxe-form--item-trigger-text"},u?_conf.default.i18n("vxe.form.unfolding"):_conf.default.i18n("vxe.form.folding")),(0,_vue.h)("i",{class:["vxe-form--item-trigger-icon",u?_conf.default.icon.FORM_FOLDING:_conf.default.icon.FORM_UNFOLDING]})])),x&&s.showMessage&&D.push((0,_vue.h)("div",{class:"vxe-form--item-valid",style:x.maxWidth?{width:x.maxWidth+"px"}:null},x.message));var T=j?{onMouseenter:function(e){t.triggerHeaderHelpEvent(e,R)},onMouseleave:t.handleTargetLeaveEvent}:{};return(0,_vue.h)("div",{ref:V,class:["vxe-form--item",e.id,q?"vxe-col--"+q+" is--span":"",h?_xeUtils.default.isFunction(h)?h(R):h:"",{"is--title":f,"is--required":U,"is--hidden":!1===d||v&&u,"is--active":!P||P(R),"is--error":g}]},[(0,_vue.h)("div",{class:"vxe-form--item-inner"},[f||M?(0,_vue.h)("div",__assign({class:["vxe-form--item-title",y?"align--"+y:null,{"is--ellipsis":E}],style:S?{width:isNaN(S)?S:S+"px"}:null,title:F?(0,_utils.getFuncText)(f):null},T),(0,_render.renderTitle)(t,e)):null,(0,_vue.h)("div",{class:["vxe-form--item-content",N?"align--"+N:null]},D)])])}(l,n):(0,_vue.h)("div",{ref:V})}}});exports.default=_default;